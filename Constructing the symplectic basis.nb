(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    319646,       7309]
NotebookOptionsPosition[    307657,       7169]
NotebookOutlinePosition[    307999,       7184]
CellTagsIndexPosition[    307956,       7181]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Copyright (c) 2021 Jason Pereira jason.pereira@york.ac.uk

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the \
\[OpenCurlyDoubleQuote]Software\[CloseCurlyDoubleQuote]), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED \[OpenCurlyDoubleQuote]AS \
IS\[CloseCurlyDoubleQuote], WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.\
\>", "Text",
 CellChangeTimes->{{3.837604433634441*^9, 
  3.8376044863315496`*^9}},ExpressionUUID->"566665cc-06ca-4988-983a-\
7c0d37124ddb"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8316489986789565`*^9, 3.831649007099366*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"96035529-c088-47d6-be94-3f455e14dfd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"sympForm_:", "1"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sympForm", "\[Equal]", "1"}], ",", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindDiagonalisingSymplectic", "[", 
   RowBox[{"V_", ",", 
    RowBox[{"sympForm_:", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Length", "[", "V", "]"}], "/", "2"}]}], ",", 
      "\[CapitalOmega]", ",", "sympEigs", ",", "denoms", ",", "prods", ",", 
      "vals", ",", "signs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "parameter", " ", "sympForm", " ", "specifies", " ", "which",
       " ", "of", " ", "two", " ", "possible", " ", "symplectic", " ", 
      "forms", " ", "to", " ", "use"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sympForm", "\[Equal]", "1"}], ",", 
       RowBox[{"\[CapitalOmega]", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"\[CapitalOmega]", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"signs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "j"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"2", "n"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sympEigs", "=", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"I", " ", 
           RowBox[{"\[CapitalOmega]", ".", "V"}]}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"2", "n"}], ";;", "2"}], "]"}], "]"}]}], ";", 
     RowBox[{"denoms", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sympEigs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"sympEigs", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], "-", 
              RowBox[{
               RowBox[{"sympEigs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "n"}], "]"}], ",", "i"}], "]"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"prods", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", "-", 
              RowBox[{
               RowBox[{"sympEigs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", "I", " ", 
               "\[CapitalOmega]"}]}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "n"}]}], "]"}], ",", 
                RowBox[{"2", "i"}]}], "]"}], ",", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "n"}]}], "]"}], ",", "j"}], "]"}]}], "]"}], 
            "]"}], "]"}], "/", 
          RowBox[{"denoms", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "//", "Chop"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"2", "n"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"prods", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "signs"}], ")"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"prods", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"2", "i"}]}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sympForm", "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", 
                RowBox[{"Re", "[", 
                 RowBox[{"vals", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}], "]"}]}]}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Im", "[", 
                RowBox[{"vals", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}], "]"}]}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "+", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"vals", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"2", "j"}]}], "]"}], "]"}], "]"}], ",", "0"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Im", "[", 
                 RowBox[{"vals", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "]"}], "]"}]}], ",", "0"}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"vals", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "n"}]}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Re", "[", 
                RowBox[{"vals", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Im", "[", 
                RowBox[{"vals", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "n"}]}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"vals", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "}"}]}], 
         "}"}], "]"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindDiagonalisingSymplecticOldMethod", "[", "V_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Length", "[", "V", "]"}], "/", "2"}]}], ",", 
      "\[CapitalOmega]", ",", "\[Gamma]", ",", "W", ",", "Wminhalf", ",", 
      "Vhalf", ",", "X", ",", "U", ",", "R"}], "}"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalOmega]", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", "=", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"TensorProduct", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[ImaginaryI]", 
               SqrtBox["2"]]}], ",", 
             FractionBox["\[ImaginaryI]", 
              SqrtBox["2"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", 
              SqrtBox["2"]], ",", 
             FractionBox["1", 
              SqrtBox["2"]]}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"W", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"I", " ", 
          RowBox[{"\[CapitalOmega]", ".", "V"}]}], "]"}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Wminhalf", "=", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"W", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Vhalf", "=", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"V", ",", 
        RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{
       RowBox[{"Vhalf", ".", "\[CapitalOmega]", ".", "Vhalf"}], "//", 
       "Chop"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"U", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Eigenvectors", "[", "X", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"\[Gamma]", ".", 
       RowBox[{"ConjugateTranspose", "[", "U", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Wminhalf", ".", "R", ".", "Vhalf"}], "//", "Chop"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.831645710406071*^9, 3.8316457271481943`*^9}, {
   3.8316458583022346`*^9, 3.831645877031409*^9}, {3.831646068339363*^9, 
   3.831646071549675*^9}, {3.8316488252386165`*^9, 3.831648828455208*^9}, {
   3.831648924512556*^9, 3.831648929460238*^9}, {3.8321892955231895`*^9, 
   3.8321893194232206`*^9}, 3.8333500621413965`*^9, 3.8333519068524313`*^9, {
   3.833352176516838*^9, 3.8333521808407354`*^9}, {3.833352473298627*^9, 
   3.833352474477989*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"10d2eec8-d24a-42e1-bb0d-198b312ac8ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "and", " ", "diagonalise", " ", "a", " ", "random", " ", 
    "covariance", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "=", "8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Generate", " ", "a", " ", "random"}], ",", " ", "positive", ",",
      " ", 
     RowBox[{"symmetric", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", "d"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "q", "]"}], ".", "q"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Covariance matrix\>\"", 
   "\[IndentingNewLine]", 
   RowBox[{"V", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Find", " ", "the", " ", "diagonalising", " ", "symplectic"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"FindDiagonalisingSymplectic", "[", "V", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\"\<Calculated symplectic matrix\>\"", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "//", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"#", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "8"}], ")"}]}]}], "]"}], "&"}]}], "//", "MatrixForm"}],
    "\[IndentingNewLine]", 
   "\"\<Verify that the calculated symplectic meets the symplectic condition.\
\>\"", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", 
        RowBox[{"Transpose", "[", "S", "]"}]}], "-", 
       RowBox[{"\[CapitalOmega]", "[", "d", "]"}]}], "//", "Chop"}], ")"}], 
    "\[Equal]", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "d"}], ",", 
        RowBox[{"2", "d"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\"\<Verify that the calculated symplectic gives the thermal \
decomposition.\>\"", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"S", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", "V", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", 
        RowBox[{"Transpose", "[", "S", "]"}]}]}], "//", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"#", ",", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "8"}], ")"}]}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"W", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.830877573582594*^9, 3.830877610075383*^9}, {
   3.8308800091105256`*^9, 3.830880009514228*^9}, {3.8308800466423407`*^9, 
   3.8308800556007586`*^9}, {3.8308801469232674`*^9, 
   3.8308801899636917`*^9}, {3.8308802545395594`*^9, 3.830880258048564*^9}, {
   3.8308802932004232`*^9, 3.830880306271776*^9}, {3.83088157008781*^9, 
   3.830881604912862*^9}, {3.830881950451828*^9, 3.8308819520117407`*^9}, {
   3.8308819978042*^9, 3.8308820793995447`*^9}, {3.8308821516675777`*^9, 
   3.8308821517246523`*^9}, 3.8308822079493265`*^9, 3.8308827035546885`*^9, {
   3.8316551087016315`*^9, 3.831655119738705*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"54f4b8cd-19a2-412d-a351-ee7ed75db43a"],

Cell[BoxData["\<\"Covariance matrix\"\>"], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.8376045061362453`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"5ad2d0d7-3b1f-4837-9f69-be115a77e8db"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"6.594598562302436`", 
      RowBox[{"-", "0.48869782929425676`"}], "1.7777902753802626`", 
      RowBox[{"-", "2.1916260772637672`"}], "1.6945169144382062`", 
      RowBox[{"-", "0.39048911041339396`"}], "2.1462731844662435`", 
      "1.6120387832563488`", 
      RowBox[{"-", "1.0363079026081192`"}], "0.7681078902767338`", 
      RowBox[{"-", "0.7819526267753738`"}], 
      RowBox[{"-", "0.677303178611655`"}], "0.7747976233635496`", 
      RowBox[{"-", "2.215992465169809`"}], 
      RowBox[{"-", "0.5111815105411838`"}], "1.4866423262598065`"},
     {
      RowBox[{"-", "0.48869782929425676`"}], "7.074920689381429`", 
      RowBox[{"-", "0.6659228242207151`"}], "0.9998904092787103`", 
      "0.16435242418429674`", "2.4506288647869985`", "0.32318685489423066`", 
      RowBox[{"-", "2.025118460594473`"}], "0.06521029376302179`", 
      RowBox[{"-", "0.31059253446465207`"}], "0.8366288694080473`", 
      "0.5114731765975786`", "2.6611726588398783`", 
      RowBox[{"-", "0.8730321503983764`"}], "1.3682325931055281`", 
      RowBox[{"-", "1.0577378069755434`"}]},
     {"1.7777902753802626`", 
      RowBox[{"-", "0.6659228242207151`"}], "6.699383328858823`", 
      "1.7428709458184195`", 
      RowBox[{"-", "0.4233031304523227`"}], 
      RowBox[{"-", "0.6247691987677209`"}], 
      RowBox[{"-", "0.869760751971095`"}], "1.5688032663752447`", 
      RowBox[{"-", "2.153022835900546`"}], 
      RowBox[{"-", "0.03868200195892133`"}], "1.987044130839318`", 
      RowBox[{"-", "2.623974217116202`"}], 
      RowBox[{"-", "0.5203335536184778`"}], "0.37599940500742246`", 
      RowBox[{"-", "0.9038861702386068`"}], "0.6458704541360166`"},
     {
      RowBox[{"-", "2.1916260772637672`"}], "0.9998904092787103`", 
      "1.7428709458184195`", "4.187338200629383`", 
      RowBox[{"-", "0.5563102766342537`"}], 
      RowBox[{"-", "0.23098304282710946`"}], 
      RowBox[{"-", "0.3621181496901701`"}], 
      RowBox[{"-", "0.5968872684958367`"}], 
      RowBox[{"-", "0.15948567760747512`"}], 
      RowBox[{"-", "0.9079274517363723`"}], "0.4765766636077699`", 
      RowBox[{"-", "0.9315201321755863`"}], 
      RowBox[{"-", "1.5042076721722704`"}], "0.16767299225442744`", 
      "0.5669384194086056`", 
      RowBox[{"-", "0.8761121474316887`"}]},
     {"1.6945169144382062`", "0.16435242418429674`", 
      RowBox[{"-", "0.4233031304523227`"}], 
      RowBox[{"-", "0.5563102766342537`"}], "3.7686164500132575`", 
      "0.4593442180827254`", 
      RowBox[{"-", "1.2969256460288523`"}], 
      RowBox[{"-", "0.10155323856694098`"}], "0.7587350027867779`", 
      "0.5870646773590752`", "0.08482391383343073`", "0.46910417712274516`", 
      RowBox[{"-", "0.1621317530843101`"}], 
      RowBox[{"-", "0.9672684786494853`"}], "1.3927260229613416`", 
      "0.21910124213602297`"},
     {
      RowBox[{"-", "0.39048911041339396`"}], "2.4506288647869985`", 
      RowBox[{"-", "0.6247691987677209`"}], 
      RowBox[{"-", "0.23098304282710946`"}], "0.4593442180827254`", 
      "4.929327774876241`", "0.66544367140005`", 
      RowBox[{"-", "1.082608533678431`"}], "1.3653265214439125`", 
      "0.6322885436020321`", 
      RowBox[{"-", "0.02584309559176161`"}], 
      RowBox[{"-", "0.3898138231680771`"}], "2.0204175392742454`", 
      RowBox[{"-", "0.31194535127090983`"}], 
      RowBox[{"-", "0.21777422473581454`"}], 
      RowBox[{"-", "1.7015883834278267`"}]},
     {"2.1462731844662435`", "0.32318685489423066`", 
      RowBox[{"-", "0.869760751971095`"}], 
      RowBox[{"-", "0.3621181496901701`"}], 
      RowBox[{"-", "1.2969256460288523`"}], "0.66544367140005`", 
      "4.700640978580695`", "0.4450015958542423`", 
      RowBox[{"-", "0.5550367983065964`"}], 
      RowBox[{"-", "1.2718467650137308`"}], 
      RowBox[{"-", "0.7018236951142006`"}], 
      RowBox[{"-", "1.091356870812653`"}], "0.17048789265840478`", 
      RowBox[{"-", "1.8138101229849173`"}], 
      RowBox[{"-", "0.7272950613530988`"}], "0.15905111754638515`"},
     {"1.6120387832563488`", 
      RowBox[{"-", "2.025118460594473`"}], "1.5688032663752447`", 
      RowBox[{"-", "0.5968872684958367`"}], 
      RowBox[{"-", "0.10155323856694098`"}], 
      RowBox[{"-", "1.082608533678431`"}], "0.4450015958542423`", 
      "3.655823924200641`", "1.028854617347802`", 
      RowBox[{"-", "0.23814671209892121`"}], "0.3502433789193233`", 
      "0.47769878912929176`", 
      RowBox[{"-", "0.4357322254412639`"}], "2.084772168568153`", 
      RowBox[{"-", "1.4026073129664896`"}], "0.6099093044772561`"},
     {
      RowBox[{"-", "1.0363079026081192`"}], "0.06521029376302179`", 
      RowBox[{"-", "2.153022835900546`"}], 
      RowBox[{"-", "0.15948567760747512`"}], "0.7587350027867779`", 
      "1.3653265214439125`", 
      RowBox[{"-", "0.5550367983065964`"}], "1.028854617347802`", 
      "5.1315522221406695`", "0.44748771413469707`", 
      RowBox[{"-", "0.017461468193092158`"}], "3.368760914013941`", 
      "0.8819868317079251`", "0.7329676538147091`", 
      RowBox[{"-", "0.6928824344454544`"}], 
      RowBox[{"-", "1.8734228591144961`"}]},
     {"0.7681078902767338`", 
      RowBox[{"-", "0.31059253446465207`"}], 
      RowBox[{"-", "0.03868200195892133`"}], 
      RowBox[{"-", "0.9079274517363723`"}], "0.5870646773590752`", 
      "0.6322885436020321`", 
      RowBox[{"-", "1.2718467650137308`"}], 
      RowBox[{"-", "0.23814671209892121`"}], "0.44748771413469707`", 
      "4.599608445292509`", 
      RowBox[{"-", "1.171007358659047`"}], "0.3631448846245688`", 
      "1.8073910866517973`", 
      RowBox[{"-", "0.5611360157098413`"}], 
      RowBox[{"-", "0.7980062266281478`"}], "0.4916353902413856`"},
     {
      RowBox[{"-", "0.7819526267753738`"}], "0.8366288694080473`", 
      "1.987044130839318`", "0.4765766636077699`", "0.08482391383343073`", 
      RowBox[{"-", "0.02584309559176161`"}], 
      RowBox[{"-", "0.7018236951142006`"}], "0.3502433789193233`", 
      RowBox[{"-", "0.017461468193092158`"}], 
      RowBox[{"-", "1.171007358659047`"}], "2.8533131590463956`", 
      "0.32703931597994407`", 
      RowBox[{"-", "0.16956182162405828`"}], 
      RowBox[{"-", "0.29113641988275907`"}], 
      RowBox[{"-", "0.5320221234862681`"}], 
      RowBox[{"-", "0.1917861392370506`"}]},
     {
      RowBox[{"-", "0.677303178611655`"}], "0.5114731765975786`", 
      RowBox[{"-", "2.623974217116202`"}], 
      RowBox[{"-", "0.9315201321755863`"}], "0.46910417712274516`", 
      RowBox[{"-", "0.3898138231680771`"}], 
      RowBox[{"-", "1.091356870812653`"}], "0.47769878912929176`", 
      "3.368760914013941`", "0.3631448846245688`", "0.32703931597994407`", 
      "5.94008364223755`", "0.6035926085879865`", 
      RowBox[{"-", "0.23390988769366916`"}], 
      RowBox[{"-", "1.6356701746361249`"}], 
      RowBox[{"-", "1.3521876198595861`"}]},
     {"0.7747976233635496`", "2.6611726588398783`", 
      RowBox[{"-", "0.5203335536184778`"}], 
      RowBox[{"-", "1.5042076721722704`"}], 
      RowBox[{"-", "0.1621317530843101`"}], "2.0204175392742454`", 
      "0.17048789265840478`", 
      RowBox[{"-", "0.4357322254412639`"}], "0.8819868317079251`", 
      "1.8073910866517973`", 
      RowBox[{"-", "0.16956182162405828`"}], "0.6035926085879865`", 
      "3.6318746035733334`", 
      RowBox[{"-", "0.7158183817415397`"}], 
      RowBox[{"-", "0.07737671007323232`"}], 
      RowBox[{"-", "0.2317921507241439`"}]},
     {
      RowBox[{"-", "2.215992465169809`"}], 
      RowBox[{"-", "0.8730321503983764`"}], "0.37599940500742246`", 
      "0.16767299225442744`", 
      RowBox[{"-", "0.9672684786494853`"}], 
      RowBox[{"-", "0.31194535127090983`"}], 
      RowBox[{"-", "1.8138101229849173`"}], "2.084772168568153`", 
      "0.7329676538147091`", 
      RowBox[{"-", "0.5611360157098413`"}], 
      RowBox[{"-", "0.29113641988275907`"}], 
      RowBox[{"-", "0.23390988769366916`"}], 
      RowBox[{"-", "0.7158183817415397`"}], "5.439681870945401`", 
      RowBox[{"-", "0.1650796614880642`"}], 
      RowBox[{"-", "0.4403935319584237`"}]},
     {
      RowBox[{"-", "0.5111815105411838`"}], "1.3682325931055281`", 
      RowBox[{"-", "0.9038861702386068`"}], "0.5669384194086056`", 
      "1.3927260229613416`", 
      RowBox[{"-", "0.21777422473581454`"}], 
      RowBox[{"-", "0.7272950613530988`"}], 
      RowBox[{"-", "1.4026073129664896`"}], 
      RowBox[{"-", "0.6928824344454544`"}], 
      RowBox[{"-", "0.7980062266281478`"}], 
      RowBox[{"-", "0.5320221234862681`"}], 
      RowBox[{"-", "1.6356701746361249`"}], 
      RowBox[{"-", "0.07737671007323232`"}], 
      RowBox[{"-", "0.1650796614880642`"}], "4.669389666486136`", 
      "1.4649298946173253`"},
     {"1.4866423262598065`", 
      RowBox[{"-", "1.0577378069755434`"}], "0.6458704541360166`", 
      RowBox[{"-", "0.8761121474316887`"}], "0.21910124213602297`", 
      RowBox[{"-", "1.7015883834278267`"}], "0.15905111754638515`", 
      "0.6099093044772561`", 
      RowBox[{"-", "1.8734228591144961`"}], "0.4916353902413856`", 
      RowBox[{"-", "0.1917861392370506`"}], 
      RowBox[{"-", "1.3521876198595861`"}], 
      RowBox[{"-", "0.2317921507241439`"}], 
      RowBox[{"-", "0.4403935319584237`"}], "1.4649298946173253`", 
      "4.8365772435173815`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.8376045061623287`*^9},
 CellLabel->
  "Out[9]//MatrixForm=",ExpressionUUID->"221432e7-d431-458f-92c5-\
3d167d80b302"],

Cell[BoxData["\<\"Calculated symplectic matrix\"\>"], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.837604506487814*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"d421243c-d4c1-4eef-aa77-c090f06c8681"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.603705354931647`", "1.0863488105473853`", 
      RowBox[{"-", "1.0160159585465205`"}], 
      RowBox[{"-", "0.9450339039073562`"}], 
      RowBox[{"-", "0.1316735917229029`"}], 
      RowBox[{"-", "0.3873269256205492`"}], "0.46777013555535635`", 
      RowBox[{"-", "0.34208783242079205`"}], 
      RowBox[{"-", "0.00627709449067239`"}], 
      RowBox[{"-", "0.17402025857965908`"}], "0.0784066814742229`", 
      "1.0672832829461862`", 
      RowBox[{"-", "0.5506676073548024`"}], "0.6046723006290037`", 
      RowBox[{"-", "0.00031111885324208044`"}], "0.016870861941474198`"},
     {"0", "0.2759537914499343`", "0.013236598925042599`", 
      RowBox[{"-", "0.02652234166131843`"}], "0.05219783444657573`", 
      RowBox[{"-", "0.06686462299881155`"}], "0.4644130339670765`", 
      "0.2502153439607031`", 
      RowBox[{"-", "0.2103876607412358`"}], "0.07179598023345829`", 
      RowBox[{"-", "0.13826518196919438`"}], "0.34051483281819356`", 
      RowBox[{"-", "0.403643846703751`"}], 
      RowBox[{"-", "0.1953109281494047`"}], 
      RowBox[{"-", "0.012572223560432298`"}], "0.08457640768904151`"},
     {
      RowBox[{"-", "0.3025568484446374`"}], 
      RowBox[{"-", "0.3686955695593979`"}], "0.5579316822106426`", 
      "0.45393985355183514`", "0.3685890175736415`", "0.11293011226256627`", 
      "0.24598918944855563`", 
      RowBox[{"-", "0.047351101048938735`"}], "0.22677524372774424`", 
      "0.4592559593743862`", "0.25465421479470945`", 
      RowBox[{"-", "0.491793009268511`"}], "0.21265233226733807`", 
      RowBox[{"-", "0.07044770222536151`"}], 
      RowBox[{"-", "0.08491428163297542`"}], 
      RowBox[{"-", "0.2521953046170012`"}]},
     {"0.25311249960978266`", 
      RowBox[{"-", "0.3423059867437955`"}], "0", "0.49212941237022206`", 
      "0.33244581946387564`", "0.6998550971755964`", "0.7252674341289511`", 
      "0.8887453701446265`", 
      RowBox[{"-", "0.1376717978645798`"}], "0.10469004449844026`", 
      RowBox[{"-", "0.2016782915935531`"}], "0.07563909677838225`", 
      RowBox[{"-", "0.5298066997897035`"}], "0.4293479409829044`", 
      RowBox[{"-", "0.03999353584182098`"}], 
      RowBox[{"-", "0.049693269518023706`"}]},
     {
      RowBox[{"-", "0.3713693366474687`"}], "0.0897828844936144`", 
      "0.03846974558611828`", 
      RowBox[{"-", "0.33048408661842027`"}], "0.04114320274934976`", 
      RowBox[{"-", "0.18129311869103404`"}], 
      RowBox[{"-", "0.32562633988506473`"}], 
      RowBox[{"-", "0.24063668140219574`"}], 
      RowBox[{"-", "0.2241868729891822`"}], "0.4582556804754713`", 
      "0.7184285716921313`", "0.06231696444014831`", "0.24302979005147707`", 
      RowBox[{"-", "0.5553067453113439`"}], "0.046322153632803086`", 
      RowBox[{"-", "0.2971870203809561`"}]},
     {"0.037899035558907175`", "0.06289657885169975`", "0.07477463702873811`", 
      RowBox[{"-", "0.41136023517992953`"}], "0", 
      RowBox[{"-", "0.33784076034129107`"}], 
      RowBox[{"-", "0.45936231607337163`"}], 
      RowBox[{"-", "0.20513386155310562`"}], 
      RowBox[{"-", "0.44982684527047384`"}], 
      RowBox[{"-", "0.26943924340960607`"}], "0.12558706390751495`", 
      "0.7536943752152816`", "0.3052172752189482`", 
      RowBox[{"-", "0.12007536037255528`"}], "0.3985163340809165`", 
      "0.35803399570106814`"},
     {"0.19870546283368695`", "0.17779131706571502`", "0.26723991839643163`", 
      "0.5068730122391544`", 
      RowBox[{"-", "0.4289153591590832`"}], 
      RowBox[{"-", "0.6377780154208199`"}], "0.25784651809226694`", 
      "0.017345965222297043`", 
      RowBox[{"-", "0.15475119561417636`"}], "0.46008459879098157`", 
      RowBox[{"-", "0.16234348330372816`"}], "0.07289155804134854`", 
      "0.09777203756811108`", 
      RowBox[{"-", "0.48775927334221597`"}], "0.09733605349988093`", 
      "0.619878673788518`"},
     {"0.008380606919514444`", "0.3539141364653471`", 
      RowBox[{"-", "0.5954254532174644`"}], 
      RowBox[{"-", "0.18793856019644653`"}], "0.2155174133065203`", 
      RowBox[{"-", "0.4836215614849314`"}], "0", "0.03325664922647733`", 
      RowBox[{"-", "0.37662721274136457`"}], "0.0561985855014264`", 
      RowBox[{"-", "0.129983977772477`"}], "0.21970401536896486`", 
      "0.05748269928947736`", "0.09867270504660204`", 
      RowBox[{"-", "0.21174816289309462`"}], "0.1930497570569095`"},
     {"0.08455440966277905`", "0.1748663388888892`", 
      RowBox[{"-", "0.042975473709216436`"}], 
      RowBox[{"-", "0.03834241771063099`"}], "0.409318384853197`", 
      RowBox[{"-", "0.2037088937058347`"}], 
      RowBox[{"-", "0.22210671445876534`"}], "0.24202823245306124`", 
      "0.1371780670868071`", 
      RowBox[{"-", "0.16552153326206423`"}], "0.005700766967656814`", 
      RowBox[{"-", "0.27996408065882655`"}], "0.025744598133658828`", 
      "0.3651672965598844`", "0.8740788041565964`", "0.4118645954337265`"},
     {
      RowBox[{"-", "0.23158481603181105`"}], 
      RowBox[{"-", "0.06967134786144201`"}], "0.17880721315752962`", 
      RowBox[{"-", "0.027880269616524605`"}], "0.2477695735654637`", 
      "0.16805667209760852`", 
      RowBox[{"-", "0.47609612892171577`"}], 
      RowBox[{"-", "0.05186200694172127`"}], "0", "0.2964133100692677`", 
      "0.303482048592435`", "0.05309071736682102`", 
      RowBox[{"-", "0.04993205829058933`"}], "0.004974443559402548`", 
      RowBox[{"-", "0.04749340956996768`"}], "0.6263517596979502`"},
     {"0.14110814055463175`", 
      RowBox[{"-", "0.06351019642139388`"}], 
      RowBox[{"-", "0.18463288547135923`"}], 
      RowBox[{"-", "0.35424080090140564`"}], 
      RowBox[{"-", "0.23163083718594743`"}], "0.06085662732674894`", 
      "0.4414656105848328`", "0.38857718780349515`", "0.3516403208600954`", 
      RowBox[{"-", "0.20458123812022602`"}], "0.17145683217285626`", 
      "0.2855485942397806`", "0.2301614273608203`", 
      RowBox[{"-", "0.006320417827764105`"}], 
      RowBox[{"-", "0.29702507401753536`"}], "0.1366415120113017`"},
     {"0.0887049711003413`", 
      RowBox[{"-", "0.22346245092249106`"}], "0.2994333408545462`", 
      RowBox[{"-", "0.10313302277016424`"}], "0.02405233073224246`", 
      RowBox[{"-", "0.13950636067955258`"}], 
      RowBox[{"-", "0.44156549821762536`"}], "0.4581159714453921`", 
      "0.35187232674594016`", "0.38221347037868403`", "0", 
      "0.37705785298446876`", "0.1166293647569802`", "0.4934844809419537`", 
      RowBox[{"-", "0.3790849619586443`"}], 
      RowBox[{"-", "0.19848903025739736`"}]},
     {
      RowBox[{"-", "0.10834904776948277`"}], "0.32903850632797776`", 
      RowBox[{"-", "0.5321287263115357`"}], 
      RowBox[{"-", "0.2305675545714403`"}], "0.020178776001992815`", 
      "0.4559962866715171`", 
      RowBox[{"-", "0.005137250382140586`"}], 
      RowBox[{"-", "0.2553343130847225`"}], "0.2600708735466325`", 
      "0.44227261489263825`", 
      RowBox[{"-", "0.3172891390629434`"}], "0.1433749897711014`", 
      "0.4797992072403341`", 
      RowBox[{"-", "0.046373556105492805`"}], "0.12490005347400727`", 
      RowBox[{"-", "0.08334425889126268`"}]},
     {
      RowBox[{"-", "0.08767906370296016`"}], 
      RowBox[{"-", "0.2484937727155631`"}], "0.2197454939627763`", 
      RowBox[{"-", "0.1344358885469857`"}], 
      RowBox[{"-", "0.3978334350185773`"}], 
      RowBox[{"-", "0.08904632496192905`"}], "0.0659697898111813`", 
      "0.0912177508017627`", 
      RowBox[{"-", "0.47162409222210033`"}], "0.06918079228768205`", 
      RowBox[{"-", "0.11263753628017077`"}], 
      RowBox[{"-", "0.5359628339806044`"}], "0", "0.3781476938225585`", 
      RowBox[{"-", "0.016048424773218894`"}], "0.2654359318520761`"},
     {
      RowBox[{"-", "0.6838692380478706`"}], 
      RowBox[{"-", "0.25247298496712217`"}], 
      RowBox[{"-", "0.3930655754188883`"}], "0.18979832159414153`", 
      RowBox[{"-", "0.19624864691785407`"}], 
      RowBox[{"-", "0.1919191777309782`"}], 
      RowBox[{"-", "0.17611689342546857`"}], 
      RowBox[{"-", "0.04881135786549721`"}], "0.24836032731466157`", 
      RowBox[{"-", "0.14693193612428707`"}], 
      RowBox[{"-", "0.046200092029271056`"}], "0.25044715635886505`", 
      RowBox[{"-", "0.26184502818997185`"}], "0.2960405762375523`", 
      "0.04834213682931933`", 
      RowBox[{"-", "0.11751570453333438`"}]},
     {"0.35813232187966987`", 
      RowBox[{"-", "0.6427301185113447`"}], 
      RowBox[{"-", "0.21774461224879704`"}], 
      RowBox[{"-", "0.3276900457864042`"}], "0.20081831602168929`", 
      RowBox[{"-", "0.2614580277958785`"}], "0.061061188811534474`", 
      "0.07744008903247142`", 
      RowBox[{"-", "0.008138660000724133`"}], "0.1873833975152331`", 
      RowBox[{"-", "0.25230143024227764`"}], "0.024022196917564582`", 
      RowBox[{"-", "0.16895332049382036`"}], 
      RowBox[{"-", "0.19963653777405002`"}], "0", "0.2275661279740528`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.837604506556636*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"23a368cf-d43a-4d72-a53d-\
062c9e67220e"],

Cell[BoxData["\<\"Verify that the calculated symplectic meets the symplectic \
condition.\"\>"], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.8376045065615187`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"1d3576e9-9b38-4877-a3db-09e8f03c2d5e"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.837604506566913*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7afa6902-79ee-4380-a600-ffb4581804d1"],

Cell[BoxData["\<\"Verify that the calculated symplectic gives the thermal \
decomposition.\"\>"], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.837604506570838*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"c609aa1d-a02b-45f6-91ec-7d5572ab10c2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2551960238081832`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0.2551960238081833`", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0.5279260796431477`", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0.527926079643145`", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1.287336708429659`", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1.2873367084296534`", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "2.144579234661215`", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2.1445792346612276`", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "3.641160374734516`", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "3.6411603747345067`", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "6.06117235661036`", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "6.061172356610335`", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "7.764149908194566`", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "7.764149908194558`", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "9.421640020329217`", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "9.421640020329177`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.830877502722356*^9, {3.830877561126643*^9, 3.830877575224922*^9}, 
   3.830877611782384*^9, 3.830880011923502*^9, 3.8308801413111205`*^9, 
   3.8308803167149773`*^9, 3.830881256822961*^9, 3.8308814384698195`*^9, 
   3.8308816062507277`*^9, 3.8308819666140013`*^9, {3.8308820127974343`*^9, 
   3.830882081387887*^9}, 3.8308821528136044`*^9, 3.830882707058855*^9, 
   3.8308917432362423`*^9, 3.830939337978537*^9, 3.831045935588546*^9, 
   3.831119674936471*^9, 3.831216329490463*^9, 3.8314912594124384`*^9, 
   3.831581028454814*^9, 3.831646121433708*^9, 3.8316489322446327`*^9, 
   3.8316490103184795`*^9, 3.8316494215238*^9, {3.8316551097577815`*^9, 
   3.831655120811899*^9}, 3.8318114662919793`*^9, 3.8318120043818884`*^9, 
   3.8318129995233636`*^9, 3.8321014973438835`*^9, 3.832164324134912*^9, 
   3.832173963376226*^9, 3.832190840439842*^9, 3.8324467603788557`*^9, 
   3.8324547502901278`*^9, 3.8332843455598927`*^9, 3.8332855183076105`*^9, 
   3.8333519194854655`*^9, 3.8333527621468563`*^9, 3.8333529031797533`*^9, 
   3.837604506578369*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"6eb5c1c3-315b-44cf-83f2-\
fb0e227b1d3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"\"\<Two mode example\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exampleTwoMode", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "c", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "a", ",", "0", ",", 
       RowBox[{"-", "c"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "0", ",", "b", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "c"}], ",", "0", ",", "b"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Covariance matrix\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"exampleTwoMode", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"Length", "[", "exampleTwoMode", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Symplectic eigenvalues\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"sympEigs", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"ToRadicals", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"I", " ", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
          "exampleTwoMode"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"2", "n"}], ";;", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", "\"\<After simplification\>\"", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpRules", "=", 
   RowBox[{"{", 
    RowBox[{"y", "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sympEigs", "=", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox["y"], "-", 
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}]}], "2"], ",", 
    FractionBox[
     RowBox[{
      SqrtBox["y"], "+", 
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}]}], "2"]}], 
   "}"}]}], "\[IndentingNewLine]", "\"\<Calculate d1 and d2\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"sympEigs", "[", 
    RowBox[{"[", "1", "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sympEigs", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
     RowBox[{
      RowBox[{"sympEigs", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"sympEigs", "[", 
    RowBox[{"[", "2", "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sympEigs", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
     RowBox[{
      RowBox[{"sympEigs", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"y", 
       RowBox[{"(", 
        RowBox[{"a", "-", "b"}], ")"}]}], "-", 
      RowBox[{
       SqrtBox["y"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "-", "b"}], ")"}], "2"]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "y"}], 
       RowBox[{"(", 
        RowBox[{"a", "-", "b"}], ")"}]}], "-", 
      RowBox[{
       SqrtBox["y"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "-", "b"}], ")"}], "2"]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Determinant values\>\"", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]1"}], ",", "c", ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "b", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"I", " ", "\[Lambda]1"}], ",", "b"}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]1"}], ",", "c", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "b", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "c"}], ",", 
        RowBox[{"I", " ", "\[Lambda]1"}], ",", "b"}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "c", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "b", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"I", " ", "\[Lambda]1"}], ",", "b"}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "c", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"I", " ", "\[Lambda]1"}], ",", "b"}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]1"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "c"}], ",", "b"}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det3", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "c"}], ",", "b"}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]1"}], ",", "c"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"I", " ", "\[Lambda]1"}]}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det4", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]1"}], ",", "c"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "0", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "c"}], ",", 
        RowBox[{"I", " ", "\[Lambda]1"}]}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]2"}], ",", "c", ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "0", ",", 
      RowBox[{"-", "c"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "b", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]2"}]}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det5", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]2"}], ",", "c", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", 
        RowBox[{"-", "c"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "b", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]2"}]}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "c", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", "\[Lambda]2"}], ",", "0", ",", 
      RowBox[{"-", "c"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "b", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]2"}]}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det6", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "c", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I", " ", "\[Lambda]2"}], ",", "0", ",", 
        RowBox[{"-", "c"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]2"}]}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]2"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", "\[Lambda]2"}], ",", "a", ",", 
      RowBox[{"-", "c"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]2"}]}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det7", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]2"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I", " ", "\[Lambda]2"}], ",", "a", ",", 
        RowBox[{"-", "c"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]2"}]}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Lambda]2"}], ",", "c"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", "\[Lambda]2"}], ",", "a", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", "b"}], "}"}]}], "}"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"det8", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Lambda]2"}], ",", "c"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I", " ", "\[Lambda]2"}], ",", "a", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "0", ",", "b"}], "}"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", "\"\<Products of s1 elements\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"prod1", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"det1", "/", "d1"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]1", "\[Rule]", 
         RowBox[{"sympEigs", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"y", "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"prod2", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"det2", "/", "d1"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]1", "\[Rule]", 
        RowBox[{"sympEigs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"prod3", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"det3", "/", "d1"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]1", "\[Rule]", 
         RowBox[{"sympEigs", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"y", "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"prod4", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"det4", "/", "d1"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]1", "\[Rule]", 
        RowBox[{"sympEigs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", "\"\<Products of s2 elements\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"prod5", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"det5", "/", "d2"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]2", "\[Rule]", 
         RowBox[{"sympEigs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"y", "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"prod6", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"det6", "/", "d2"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]2", "\[Rule]", 
        RowBox[{"sympEigs", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"prod7", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"det7", "/", "d2"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]2", "\[Rule]", 
         RowBox[{"sympEigs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"y", "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]}]}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod1", "/", 
      RowBox[{"Sqrt", "[", "prod2", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod2", "/", 
      RowBox[{"Sqrt", "[", "prod2", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod3", "/", 
      RowBox[{"Sqrt", "[", "prod2", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod4", "/", 
      RowBox[{"Sqrt", "[", "prod2", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", 
   "y"}]}], "\[IndentingNewLine]", "\"\<Elements of s2\>\"", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod5", "/", 
      RowBox[{"Sqrt", "[", "prod8", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod6", "/", 
      RowBox[{"Sqrt", "[", "prod8", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod7", "/", 
      RowBox[{"Sqrt", "[", "prod8", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prod8", "/", 
      RowBox[{"Sqrt", "[", "prod8", "]"}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["c", "2"]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"b", ">", "1"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}]}], "\[Rule]", "y"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpRules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Append", "[", 
     RowBox[{"simpRules", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]p", "\[Rule]", 
         FractionBox[
          SqrtBox[
           FractionBox[
            RowBox[{"a", "+", "b", "+", 
             SqrtBox["y"]}], 
            SqrtBox["y"]]], 
          SqrtBox["2"]]}], ",", 
        RowBox[{"\[Omega]m", "\[Rule]", 
         FractionBox[
          SqrtBox[
           FractionBox[
            RowBox[{"a", "+", "b", "-", 
             SqrtBox["y"]}], 
            SqrtBox["y"]]], 
          SqrtBox["2"]]}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<After some simplification, we have \
expressions for s1 and s2\>\"", "\[IndentingNewLine]", 
 RowBox[{"s1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]m"}], ",", "\[Omega]m", 
    ",", 
    RowBox[{"\[ImaginaryI]", " ", "\[Omega]p"}], ",", "\[Omega]p"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"s2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", "\[Omega]p"}], ",", "\[Omega]p", ",", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]m"}], ",", "\[Omega]m"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "s2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Calculated diagonalising \
symplectic\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"Re", "[", 
               RowBox[{"vals", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}], "]"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Im", "[", 
              RowBox[{"vals", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}], "]"}]}], 
            "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "+", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{"vals", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "j"}]}], "]"}], "]"}], "]"}], ",", "0"}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Im", "[", 
               RowBox[{"vals", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"2", "j"}]}], "]"}], "]"}], "]"}]}], ",", "0"}], 
            "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"\[Omega]m", "|", "\[Omega]p"}], ",", "Reals"}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"S", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8312171031775975`*^9, 3.831217120257934*^9}, {
   3.831558567776018*^9, 3.8315586189856052`*^9}, {3.831558654707822*^9, 
   3.8315586601838617`*^9}, {3.831558701386368*^9, 3.831558803418705*^9}, {
   3.831560218873782*^9, 3.8315602541253796`*^9}, {3.831560353051057*^9, 
   3.831560355792735*^9}, {3.8315603891000752`*^9, 3.8315604263106685`*^9}, {
   3.831561244898136*^9, 3.831561279243353*^9}, {3.8315614914671297`*^9, 
   3.8315615843736305`*^9}, {3.831562577102737*^9, 3.831562643867507*^9}, {
   3.8315626756118617`*^9, 3.8315626773306894`*^9}, {3.831562710966146*^9, 
   3.8315627311719093`*^9}, {3.831562937917632*^9, 3.831562940711361*^9}, 
   3.831563012290629*^9, {3.831563052893057*^9, 3.8315630592213497`*^9}, {
   3.8315630899509373`*^9, 3.831563169000594*^9}, {3.831563261246233*^9, 
   3.831563263667879*^9}, {3.8315633483463297`*^9, 3.8315633815210004`*^9}, {
   3.831563847573859*^9, 3.831563891153948*^9}, {3.8315642865981936`*^9, 
   3.831564331409231*^9}, {3.8315720707883472`*^9, 3.8315723874314723`*^9}, 
   3.831576772928378*^9, {3.8315770243621874`*^9, 3.8315770366808224`*^9}, {
   3.831577945312764*^9, 3.8315779548289337`*^9}, {3.8315782444932833`*^9, 
   3.8315782502286105`*^9}, {3.831578301496395*^9, 3.831578304003868*^9}, {
   3.8315789793974953`*^9, 3.8315790066366014`*^9}, {3.8315792238632774`*^9, 
   3.831579232624112*^9}, {3.831579356064252*^9, 3.8315793614315805`*^9}, {
   3.8315794522195635`*^9, 3.8315794945048237`*^9}, {3.8315797563812785`*^9, 
   3.8315797567039*^9}, {3.8315798912100925`*^9, 3.8315798941069927`*^9}, {
   3.8316492004875293`*^9, 3.831649214281659*^9}, {3.831649397500867*^9, 
   3.8316494129033594`*^9}, {3.83181035972123*^9, 3.8318103655724974`*^9}, {
   3.8332844717652903`*^9, 3.8332844739599915`*^9}, {3.833284605299803*^9, 
   3.8332846082910433`*^9}, {3.8332846660091124`*^9, 
   3.8332847040898905`*^9}, {3.8332853407441645`*^9, 
   3.8332853881236844`*^9}, {3.8333393212553444`*^9, 
   3.8333393234020815`*^9}, {3.8333498069580126`*^9, 3.833349808838076*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"f190226c-745c-4888-a4b8-b9c06906695c"],

Cell[BoxData["\<\"Two mode example\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045066794863`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"24bb6b30-4cac-4ce9-ac99-f0346be38734"],

Cell[BoxData["\<\"Covariance matrix\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604506685438*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"e8bd9246-42e5-4870-aacd-b309abfc8074"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", "c", "0"},
     {"0", "a", "0", 
      RowBox[{"-", "c"}]},
     {"c", "0", "b", "0"},
     {"0", 
      RowBox[{"-", "c"}], "0", "b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604506689453*^9},
 CellLabel->
  "Out[21]//MatrixForm=",ExpressionUUID->"2feb68aa-319e-400f-9b59-\
bd0287f74afa"],

Cell[BoxData["\<\"Symplectic eigenvalues\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045067003994`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"bd8277e1-3173-41a0-95df-f6a38f621a03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SqrtBox[
     RowBox[{"Abs", "[", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}], "-", 
       RowBox[{"a", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"2", " ", "a", " ", "b"}], "+", 
          SuperscriptBox["b", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]]}], "+", 
       RowBox[{"b", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"2", " ", "a", " ", "b"}], "+", 
          SuperscriptBox["b", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]]}]}], "]"}]], 
    SqrtBox["2"]], ",", 
   FractionBox[
    SqrtBox[
     RowBox[{"Abs", "[", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}], "+", 
       RowBox[{"a", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"2", " ", "a", " ", "b"}], "+", 
          SuperscriptBox["b", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]]}], "-", 
       RowBox[{"b", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"2", " ", "a", " ", "b"}], "+", 
          SuperscriptBox["b", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["c", "2"]}]}]]}]}], "]"}]], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507063511*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"577f61ae-c2ae-466c-9de0-80c2149dd225"],

Cell[BoxData["\<\"After simplification\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507095413*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"d7bb3da7-4252-49a7-b748-9a0d64dc9f23"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "a"}], "+", "b", "+", 
      SqrtBox["y"]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"a", "-", "b", "+", 
      SqrtBox["y"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507102425*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"cc88b3ff-e9aa-4684-8fdb-75cfa3eb6426"],

Cell[BoxData["\<\"Calculate d1 and d2\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045071163554`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"b39897fa-fc0b-40e2-b5d8-093e2c12e20c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", "b"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", "b", "-", 
    SqrtBox["y"]}], ")"}], " ", 
  SqrtBox["y"]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507351696*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"e10d4526-49dd-4871-b4bd-c727086ff0ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", "b"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", "b", "+", 
    SqrtBox["y"]}], ")"}], " ", 
  SqrtBox["y"]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045073706408`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"4fb58d7e-ddbb-4c68-ac91-c0805ee5b3c5"],

Cell[BoxData["\<\"Determinant values\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.83760450737862*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"d4d40eaa-ce84-417c-ae04-31a70bcb9fee"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]1"}], "c", "0"},
     {"0", "b", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]1"}]},
     {
      RowBox[{"-", "c"}], 
      RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}], "b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507385601*^9},
 CellLabel->
  "Out[34]//MatrixForm=",ExpressionUUID->"570dc411-c4c2-4036-bbca-\
046f951acfef"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["b", "2"]}], "+", 
    SuperscriptBox["c", "2"], "+", 
    SuperscriptBox["\[Lambda]1", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045073906155`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"8e7bc0b1-12b7-4ab1-88b8-5eb5d0d4bedf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "c", "0"},
     {"c", "b", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]1"}]},
     {"0", 
      RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}], "b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507399564*^9},
 CellLabel->
  "Out[36]//MatrixForm=",ExpressionUUID->"1747ba65-59ce-4c64-a644-\
48187b59e6af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "b"}], " ", 
   SuperscriptBox["c", "2"]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", "\[Lambda]1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", "\[Lambda]1"}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507405546*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"bf2f0dfd-8cd0-475a-8f2a-80f05dc41ab1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]1"}], "0"},
     {"c", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]1"}]},
     {"0", 
      RowBox[{"-", "c"}], "b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507412568*^9},
 CellLabel->
  "Out[38]//MatrixForm=",ExpressionUUID->"1b3b5484-17d7-4df8-9693-\
54ad0e096ed8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", "b"}], ")"}], " ", "c", " ", "\[Lambda]1"}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045074175467`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"3d8a2125-b7a4-4ae0-bfe8-cdc47807f6d8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]1"}], "c"},
     {"c", "0", "b"},
     {"0", 
      RowBox[{"-", "c"}], 
      RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045074225054`*^9},
 CellLabel->
  "Out[40]//MatrixForm=",ExpressionUUID->"492fd20b-298a-40b9-89f1-\
d63732d59eed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "a"}], " ", "b"}], "+", 
    SuperscriptBox["c", "2"], "+", 
    SuperscriptBox["\[Lambda]1", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507430481*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"056b6533-2368-47dd-bb67-7dea78ed9ca4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]2"}], "c", "0"},
     {"a", "0", 
      RowBox[{"-", "c"}]},
     {"0", "b", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045074355044`*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"7727df5e-9d42-4c6b-bb41-\
a8cf06ba51f2"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", "b"}], ")"}], " ", "c", " ", "\[Lambda]2"}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507439493*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"f314aa33-d0a7-4be9-8ea1-2f81902acf17"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "c", "0"},
     {
      RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}], "0", 
      RowBox[{"-", "c"}]},
     {"c", "b", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045074454722`*^9},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"73044a29-2677-40a1-8d30-\
70f705edb797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "a"}], " ", "b"}], "+", 
    SuperscriptBox["c", "2"], "+", 
    SuperscriptBox["\[Lambda]2", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507450429*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"94885fb5-31b2-4c32-b09f-ed98b562ef07"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]2"}], "0"},
     {
      RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}], "a", 
      RowBox[{"-", "c"}]},
     {"c", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507456458*^9},
 CellLabel->
  "Out[46]//MatrixForm=",ExpressionUUID->"a2ed4267-2f71-4108-a7e4-\
fdf5776f6d30"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["a", "2"]}], "+", 
    SuperscriptBox["c", "2"], "+", 
    SuperscriptBox["\[Lambda]2", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.83760450746142*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"b252351d-0ece-462d-9301-bf78cbe5c877"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Lambda]2"}], "c"},
     {
      RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}], "a", "0"},
     {"c", "0", "b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507467382*^9},
 CellLabel->
  "Out[48]//MatrixForm=",ExpressionUUID->"8d12c012-e70b-4c8c-a659-\
8fdf432486f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["a", "2"], " ", "b"}], "-", 
  RowBox[{"a", " ", 
   SuperscriptBox["c", "2"]}], "-", 
  RowBox[{"b", " ", 
   SuperscriptBox["\[Lambda]2", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507471403*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"62c6f485-8fc3-4f49-bf65-a3bb5f45e615"],

Cell[BoxData["\<\"Products of s1 elements\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045074763927`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"dd3281ec-a616-41ed-94d3-b8b5201f10bf"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "-", "b", "+", 
         SqrtBox["y"]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox["c", "2"]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604507964633*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"c8e814f4-b8f7-4d4d-97dd-cd65f336e638"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"4", " ", 
    SuperscriptBox["c", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", "b"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "a"}], "-", "b", "+", 
      SqrtBox["y"]}], ")"}]}]}], 
  RowBox[{
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox["c", "2"]}]}]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045080394306`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"95234e29-2654-4b29-a471-7dd323e76a93"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "c"}], 
  SqrtBox["y"]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045081192193`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"deeb14f0-97c6-4fc3-a44f-e8957077bd18"],

Cell[BoxData[
 FractionBox["c", 
  SqrtBox["y"]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604508177065*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"c41b60d5-526a-4b6c-83f9-dbf714663410"],

Cell[BoxData["\<\"Products of s2 elements\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045081850414`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"29cbf56a-ac91-48a1-bf59-55f24d5c7c5b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "c"}], 
  SqrtBox["y"]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045082797966`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"d560780f-55a3-4fe2-b6c0-87eb7f80936c"],

Cell[BoxData[
 FractionBox["c", 
  SqrtBox["y"]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045083476453`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"c4d361cb-d617-4b35-9e9d-c09fa37a25c0"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "-", "b", "+", 
         SqrtBox["y"]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox["c", "2"]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604508465293*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"1f4a6b3a-86d1-4622-a657-19955351c2ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["c", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", "b"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "-", "b", "+", 
        SqrtBox["y"]}], ")"}]}]}], 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["c", "2"]}]}]]]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604509000861*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"edca7a63-542b-4ef9-adc0-8fca03f56d0b"],

Cell[BoxData[
 SqrtBox[
  FractionBox[
   RowBox[{
    RowBox[{"4", " ", 
     SuperscriptBox["c", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", "b"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "-", "b", "+", 
       SqrtBox["y"]}], ")"}]}]}], 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox["c", "2"]}]}]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604509056711*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"2c449af5-5339-4d6b-bd45-235b75cd7253"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "c"}], 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "-", "b", "+", 
         SqrtBox["y"]}], ")"}]}]}], 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["c", "2"]}]}]]], " ", 
   SqrtBox["y"]}]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045095035563`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"289c6f0d-37c3-43e4-8463-fb52fcc87258"],

Cell[BoxData[
 FractionBox["c", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "-", "b", "+", 
         SqrtBox["y"]}], ")"}]}]}], 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["c", "2"]}]}]]], " ", 
   SqrtBox["y"]}]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045096551094`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"fd757d17-b1a4-44ff-b918-66ed5c499b4a"],

Cell[BoxData["\<\"Elements of s2\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045096641197`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"5727d5da-b3a9-4dc3-b0f9-7b5c0a2bf395"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "c"}], 
  RowBox[{
   SqrtBox["prod8"], " ", 
   SqrtBox["y"]}]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045097299166`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"574af02a-5678-42f9-a293-747fcbc650a6"],

Cell[BoxData[
 FractionBox["c", 
  RowBox[{
   SqrtBox["prod8"], " ", 
   SqrtBox["y"]}]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045097817717`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"27592fac-4ae1-4a42-ac63-77f7195fe42b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["c", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "-", "b", "+", 
         SqrtBox["y"]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["c", "2"]}]}], ")"}], " ", 
    SqrtBox["prod8"]}]]}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045099233913`*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"cfeeead8-6395-4db0-b80d-9383135044d3"],

Cell[BoxData[
 SqrtBox["prod8"]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045099323993`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"98893cad-ade4-45c0-ae1f-9864277b75b3"],

Cell[BoxData["\<\"After some simplification, we have expressions for s1 and \
s2\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604509938383*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"f9a33df0-fe17-466c-ab3f-afa10e7bff7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]m"}], ",", "\[Omega]m", ",", 
   RowBox[{"\[ImaginaryI]", " ", "\[Omega]p"}], ",", "\[Omega]p"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045099423738`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"e7873b26-63bb-439b-b130-48a28db95862"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "\[Omega]p"}], ",", "\[Omega]p", ",", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]m"}], ",", "\[Omega]m"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.837604509951318*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"63ebcd32-6a04-4969-87da-71deba9ee842"],

Cell[BoxData["\<\"Calculated diagonalising symplectic\"\>"], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045099553432`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"934d9256-ec0c-46fb-b462-1c1b1b8e6f0a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[Omega]m", "0", "\[Omega]p", "0"},
     {"0", 
      RowBox[{"-", "\[Omega]m"}], "0", "\[Omega]p"},
     {"\[Omega]p", "0", "\[Omega]m", "0"},
     {"0", "\[Omega]p", "0", 
      RowBox[{"-", "\[Omega]m"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312171278300138`*^9, 3.8312171630399103`*^9, 3.8314914071717677`*^9, 
   3.831558580305273*^9, 3.8315586143191595`*^9, 3.831558797015667*^9, 
   3.831558845073645*^9, 3.831559018827236*^9, 3.831560278852871*^9, {
   3.83156040156592*^9, 3.8315604282125387`*^9}, 3.8315612800181837`*^9, {
   3.831561566554221*^9, 3.831561585548695*^9}, {3.831562630741493*^9, 
   3.8315626469379063`*^9}, 3.8315626782937307`*^9, 3.8315627324754114`*^9, 
   3.8315632772993617`*^9, 3.8315633825238314`*^9, 3.8315638954317713`*^9, 
   3.831564332168395*^9, 3.831572237178395*^9, 3.831572395689761*^9, 
   3.8315753096347747`*^9, 3.8315767817342587`*^9, 3.8315770395360146`*^9, 
   3.831577955878356*^9, 3.8315792344022255`*^9, 3.83157937542785*^9, {
   3.8315794671410456`*^9, 3.831579496188576*^9}, 3.8315797588823013`*^9, 
   3.8315798949131603`*^9, 3.831581200650915*^9, 3.831646162019802*^9, 
   3.8316490213919716`*^9, 3.83164921728631*^9, 3.8316495999446335`*^9, 
   3.83181146681925*^9, 3.8318120045445833`*^9, 3.831812999694623*^9, 
   3.832101497699931*^9, 3.832164324372546*^9, 3.8321908406612053`*^9, 
   3.8324467610849285`*^9, 3.832454750506263*^9, 3.8332843464715557`*^9, 
   3.833284482200695*^9, 3.833284705652624*^9, 3.833285391098012*^9, 
   3.8332855185339317`*^9, 3.833351919627002*^9, 3.833352903315544*^9, 
   3.8376045099603043`*^9},
 CellLabel->
  "Out[75]//MatrixForm=",ExpressionUUID->"6cd4f37a-0c03-4d0b-8cc3-\
cdaddc774c59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"\"\<Three mode example\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exampleThreeMode", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{"c", " ", 
         RowBox[{"PauliMatrix", "[", "3", "]"}]}], ",", 
        RowBox[{"c", " ", 
         RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", " ", 
         RowBox[{"PauliMatrix", "[", "3", "]"}]}], ",", 
        RowBox[{"a", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{"c", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", " ", 
         RowBox[{"PauliMatrix", "[", "3", "]"}]}], ",", 
        RowBox[{"c", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{"a", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", "\"\<Covariance matrix\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"exampleThreeMode", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"Length", "[", "exampleThreeMode", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Symplectic eigenvalues\>\"", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sympEigs", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"ToRadicals", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"I", " ", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
           "exampleThreeMode"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"2", "n"}], ";;", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "1"}], ",", 
       RowBox[{"c", ">", "0"}], ",", 
       RowBox[{"a", ">", "c"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "denominators", " ", "to", " ", "divide", " ", "the", 
    " ", "expressions", " ", "by"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denoms", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sympEigs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"Apply", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], "-", 
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "n"}], "]"}], ",", "i"}], "]"}]}], "}"}]}],
            "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "1"}], ",", 
       RowBox[{"c", ">", "0"}], ",", 
       RowBox[{"a", ">", "c"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Substitutions to simplify the \
expressions\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["a", "2"]}], "+", 
       RowBox[{"4", " ", "a", " ", "c"}], "-", 
       RowBox[{"7", " ", 
        SuperscriptBox["c", "2"]}]}]}], ",", 
     RowBox[{"\[Lambda]2", "\[Rule]", 
      RowBox[{"sympEigs", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Plus", " ", "or", " ", "minus", " ", "signs", " ", "for", " ", "each", 
    " ", "expression"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"signs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", "j"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"2", "n"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"We", " ", "calculate", " ", 
     SuperscriptBox[
      SubscriptBox["s", "4"], "*"], 
     SubscriptBox["s", "j"], " ", "rather", " ", "than", " ", 
     SuperscriptBox[
      SubscriptBox["s", "2"], "*"], 
     SubscriptBox["s", "j"], " ", "because", " ", 
     SubscriptBox["s", "2"]}], "=", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods1", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"exampleThreeMode", "-", 
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "I", " ", 
              RowBox[{"\[CapitalOmega]", "[", "n", "]"}]}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "4"}], "]"}], ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "i"}], "]"}]}], "]"}], 
           "]"}], "]"}], "/", 
         RowBox[{"denoms", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "//", "Chop"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"2", "n"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"c", ">", "0"}], ",", 
       RowBox[{"a", ">", "c"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Det", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"exampleThreeMode", "-", 
                   RowBox[{
                    RowBox[{"sympEigs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "I", " ", 
                    RowBox[{"\[CapitalOmega]", "[", "n", "]"}]}]}], ")"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "n"}]}], "]"}], ",", "4"}], "]"}], ",", 
                   RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "n"}]}], "]"}], ",", "i"}], "]"}]}], "]"}], 
                 "]"}], "]"}], "/", 
               RowBox[{"denoms", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "//", "Chop"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"2", "n"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", ">", "0"}], ",", 
             RowBox[{"c", ">", "0"}], ",", 
             RowBox[{"a", ">", "c"}]}], "}"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"4", " ", "a", " ", "c"}], "-", 
            RowBox[{"7", " ", 
             SuperscriptBox["c", "2"]}]}], "\[Rule]", "x"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", ">", "0"}], ",", 
          RowBox[{"c", ">", "0"}], ",", 
          RowBox[{"a", ">", "c"}], ",", 
          RowBox[{"x", ">", "0"}]}], "}"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["a", "3"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "2"], " ", "c"}], "-", 
          RowBox[{"9", " ", "a", " ", 
           SuperscriptBox["c", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["c", "3"]}]}], "\[Rule]", 
         RowBox[{
          RowBox[{"a", " ", "x"}], "-", 
          RowBox[{"2", 
           SuperscriptBox["c", "2"], 
           RowBox[{"(", 
            RowBox[{"a", "-", "c"}], ")"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["a", "2"]}], "+", 
          RowBox[{"8", "a", " ", "c"}], "-", 
          RowBox[{"14", 
           SuperscriptBox["c", "2"]}]}], "\[Rule]", 
         RowBox[{"2", "x"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"]}], "+", 
          RowBox[{"2", " ", "a", " ", "c"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "c"}], "+", 
             SqrtBox["x"]}], ")"}]}]}], "\[Rule]", 
         RowBox[{"2", 
          SuperscriptBox["\[Lambda]2", "2"]}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"c", ">", "0"}], ",", 
       RowBox[{"a", ">", "c"}], ",", 
       RowBox[{"x", ">", "0"}], ",", 
       RowBox[{"\[Lambda]2", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods3", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Det", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"exampleThreeMode", "-", 
                   RowBox[{
                    RowBox[{"sympEigs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", "I", " ", 
                    RowBox[{"\[CapitalOmega]", "[", "n", "]"}]}]}], ")"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "n"}]}], "]"}], ",", "6"}], "]"}], ",", 
                   RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "n"}]}], "]"}], ",", "i"}], "]"}]}], "]"}], 
                 "]"}], "]"}], "/", 
               RowBox[{"denoms", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "//", "Chop"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"2", "n"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", ">", "0"}], ",", 
             RowBox[{"c", ">", "0"}], ",", 
             RowBox[{"a", ">", "c"}]}], "}"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"4", " ", "a", " ", "c"}], "-", 
            RowBox[{"7", " ", 
             SuperscriptBox["c", "2"]}]}], "\[Rule]", "x"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", ">", "0"}], ",", 
          RowBox[{"x", ">", "0"}]}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["a", "3"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["a", "2"], " ", "c"}], "-", 
         RowBox[{"9", " ", "a", " ", 
          SuperscriptBox["c", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "3"]}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "x"}], "-", 
         RowBox[{"2", 
          SuperscriptBox["c", "2"], 
          RowBox[{"(", 
           RowBox[{"a", "-", "c"}], ")"}]}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"c", ">", "0"}], ",", 
       RowBox[{"a", ">", "c"}], ",", 
       RowBox[{"x", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals1", "=", 
   RowBox[{"prods1", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"prods1", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"prods2", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"prods2", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"8", " ", 
          SuperscriptBox["a", "2"]}], "+", 
         RowBox[{"8", " ", "a", " ", "c"}], "-", 
         RowBox[{"14", " ", 
          SuperscriptBox["c", "2"]}]}], "\[Rule]", 
        RowBox[{"2", "x"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"c", ">", "0"}], ",", 
       RowBox[{"a", ">", "c"}], ",", 
       RowBox[{"x", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vals3", "=", 
    RowBox[{"prods3", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"prods3", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Simplifications", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals2", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "c", 
       SqrtBox["\[Lambda]2"]}], 
      SqrtBox[
       RowBox[{
        SqrtBox["x"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"c", "+", 
             SqrtBox["x"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]2", "2"]}]}], ")"}]}]]], ",", 
     FractionBox[
      RowBox[{"2", " ", "c", 
       SqrtBox["\[Lambda]2"]}], 
      SqrtBox[
       RowBox[{
        SqrtBox["x"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"c", "+", 
             SqrtBox["x"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]2", "2"]}]}], ")"}]}]]], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"c", "+", 
            SqrtBox["x"]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Lambda]2", "2"]}]}], 
        RowBox[{
         SqrtBox["x"], " ", "\[Lambda]2"}]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"c", "+", 
            SqrtBox["x"]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Lambda]2", "2"]}]}], 
        RowBox[{
         SqrtBox["x"], " ", "\[Lambda]2"}]]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"c", "+", 
            SqrtBox["x"]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Lambda]2", "2"]}]}], 
        RowBox[{
         SqrtBox["x"], " ", "\[Lambda]2"}]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"c", "+", 
            SqrtBox["x"]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Lambda]2", "2"]}]}], 
        RowBox[{
         SqrtBox["x"], " ", "\[Lambda]2"}]]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "a"}], "+", "c", "+", 
         SqrtBox["x"]}], 
        RowBox[{"2", 
         SqrtBox["x"]}]]]}], ",", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "a"}], "+", "c", "+", 
        SqrtBox["x"]}], 
       RowBox[{"2", 
        SqrtBox["x"]}]]], ",", 
     RowBox[{
      FractionBox["\[ImaginaryI]", "2"], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "a"}], "+", "c", "-", 
         SqrtBox["x"]}], 
        SqrtBox["x"]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "a"}], "+", "c", "-", 
         SqrtBox["x"]}], 
        SqrtBox["x"]]]}], ",", 
     RowBox[{
      FractionBox["\[ImaginaryI]", "2"], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "a"}], "+", "c", "-", 
         SqrtBox["x"]}], 
        SqrtBox["x"]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "a"}], "+", "c", "-", 
         SqrtBox["x"]}], 
        SqrtBox["x"]]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"signs", "*", "#"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"vals1", ",", "vals2", ",", "vals3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Calculated diagonalising \
symplectic\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"vals", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "+", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vals", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"2", "j"}]}], "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S", "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Check the symplectic condition \
for an arbitrary choice of parameters\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S", ".", 
       RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
       RowBox[{"Transpose", "[", "S", "]"}]}], "//.", "simpRules"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "5"}], ",", 
      RowBox[{"c", "\[Rule]", "1.2"}]}], "}"}]}], "//", "Chop"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Diagonalise the example \
covariance matrix for an arbitrary choice of parameters\>\"", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"S", ".", 
       RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", "exampleThreeMode", 
       ".", 
       RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
       RowBox[{"Transpose", "[", "S", "]"}]}]}], "//.", "simpRules"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "5"}], ",", 
      RowBox[{"c", "\[Rule]", "1.2"}]}], "}"}]}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8316314893908167`*^9, 3.831631490595267*^9}, 
   3.8316315255360794`*^9, 3.831632018838153*^9, {3.83163211531824*^9, 
   3.8316321158831635`*^9}, {3.8316323244519205`*^9, 
   3.8316323248874598`*^9}, {3.8316323745729475`*^9, 3.831632375782495*^9}, {
   3.8316324071104383`*^9, 3.8316324668738422`*^9}, {3.8316325395215197`*^9, 
   3.8316325409427276`*^9}, {3.8316385559352655`*^9, 
   3.8316385912321606`*^9}, {3.8316394856182632`*^9, 3.831639492102995*^9}, {
   3.8316427528991275`*^9, 3.8316427586512403`*^9}, {3.831642862930896*^9, 
   3.8316428641878386`*^9}, 3.8316432061789474`*^9, 3.8316433174428654`*^9, 
   3.831645380833725*^9, {3.8316461787842636`*^9, 3.8316461792379065`*^9}, {
   3.831646430601573*^9, 3.831646448387686*^9}, {3.8316465362614336`*^9, 
   3.8316465374696198`*^9}, {3.8316465954713006`*^9, 
   3.8316465958601246`*^9}, {3.831646824393079*^9, 3.831646842575924*^9}, {
   3.831649033361436*^9, 3.831649043454105*^9}, {3.8316493597991514`*^9, 
   3.8316493755696073`*^9}, {3.8316506879439607`*^9, 
   3.8316506915896645`*^9}, {3.8318103095261774`*^9, 3.831810321116561*^9}, {
   3.831810378699903*^9, 3.8318104650543246`*^9}, {3.8318105785644207`*^9, 
   3.831810673583996*^9}, {3.831810811282257*^9, 3.8318108821149163`*^9}, {
   3.831810930534443*^9, 3.83181099465956*^9}, {3.831811056848511*^9, 
   3.831811059956767*^9}, {3.8318111713035913`*^9, 3.8318111933976097`*^9}, {
   3.831811228625081*^9, 3.8318112760684967`*^9}, {3.8318113929077177`*^9, 
   3.8318114361395087`*^9}, 3.8318115533865824`*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"b83016c3-f0ae-4f4c-ae8a-bf8f4e20c1ae"],

Cell[BoxData["\<\"Three mode example\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045100960875`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"788593e5-c251-44d4-9076-c085fd2521bf"],

Cell[BoxData["\<\"Covariance matrix\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045101629405`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"60a73f94-9583-4fb2-a4e0-805c1da1af71"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", "c", "0", "c", "0"},
     {"0", "a", "0", 
      RowBox[{"-", "c"}], "0", 
      RowBox[{"-", "c"}]},
     {"c", "0", "a", "0", "c", "0"},
     {"0", 
      RowBox[{"-", "c"}], "0", "a", "0", "c"},
     {"c", "0", "c", "0", "a", "0"},
     {"0", 
      RowBox[{"-", "c"}], "0", "c", "0", "a"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.837604510169923*^9},
 CellLabel->
  "Out[79]//MatrixForm=",ExpressionUUID->"f15444fa-71ea-4e70-8b09-\
7d6250003da8"],

Cell[BoxData["\<\"Symplectic eigenvalues\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045101748857`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"8733887f-c842-443c-b48a-e53ae3ab86e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "-", "c"}], ",", 
   FractionBox[
    SqrtBox[
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"]}], "+", 
      RowBox[{"2", " ", "a", " ", "c"}], "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c"}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"]}], "+", 
           RowBox[{"4", " ", "a", " ", "c"}], "-", 
           RowBox[{"7", " ", 
            SuperscriptBox["c", "2"]}]}]]}], ")"}]}]}]], 
    SqrtBox["2"]], ",", 
   FractionBox[
    SqrtBox[
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"]}], "+", 
      RowBox[{"2", " ", "a", " ", "c"}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "c"}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"]}], "+", 
           RowBox[{"4", " ", "a", " ", "c"}], "-", 
           RowBox[{"7", " ", 
            SuperscriptBox["c", "2"]}]}]]}], ")"}]}]}]], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.837604510365172*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"ab0cafd4-52f6-4e77-92b7-d4b056866ebf"],

Cell[BoxData["\<\"Substitutions to simplify the expressions\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045116018653`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"84242ea6-aa2c-403b-af19-11055bd8185d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"]}], "+", 
     RowBox[{"4", " ", "a", " ", "c"}], "-", 
     RowBox[{"7", " ", 
      SuperscriptBox["c", "2"]}]}]}], ",", 
   RowBox[{"\[Lambda]2", "\[Rule]", 
    FractionBox[
     SqrtBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"]}], "+", 
       RowBox[{"2", " ", "a", " ", "c"}], "+", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "c"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"4", " ", "a", " ", "c"}], "-", 
            RowBox[{"7", " ", 
             SuperscriptBox["c", "2"]}]}]]}], ")"}]}]}]], 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045116088467`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"5e2121c3-d2b4-4fcf-9c89-ddd7fc843a3c"],

Cell[BoxData["\<\"Calculated diagonalising symplectic\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045230565615`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"7f26518c-32b0-4daa-9e17-19e9ab45b885"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{"2", " ", "c", " ", 
        SqrtBox["\[Lambda]2"]}], 
       SqrtBox[
        RowBox[{
         SqrtBox["x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"c", "+", 
              SqrtBox["x"]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Lambda]2", "2"]}]}], ")"}]}]]], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"c", "+", 
             SqrtBox["x"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]2", "2"]}]}], 
         RowBox[{
          SqrtBox["x"], " ", "\[Lambda]2"}]]]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"c", "+", 
             SqrtBox["x"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]2", "2"]}]}], 
         RowBox[{
          SqrtBox["x"], " ", "\[Lambda]2"}]]]}], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", 
         SqrtBox["\[Lambda]2"]}], 
        SqrtBox[
         RowBox[{
          SqrtBox["x"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{"c", "+", 
               SqrtBox["x"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Lambda]2", "2"]}]}], ")"}]}]]]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"c", "+", 
             SqrtBox["x"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]2", "2"]}]}], 
         RowBox[{
          SqrtBox["x"], " ", "\[Lambda]2"}]]]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"c", "+", 
             SqrtBox["x"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]2", "2"]}]}], 
         RowBox[{
          SqrtBox["x"], " ", "\[Lambda]2"}]]]}]},
     {
      FractionBox[
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "a"}], "+", "c", "+", 
          SqrtBox["x"]}], 
         SqrtBox["x"]]], 
       SqrtBox["2"]], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "a"}], "+", "c", "-", 
          SqrtBox["x"]}], 
         SqrtBox["x"]]]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "a"}], "+", "c", "-", 
          SqrtBox["x"]}], 
         SqrtBox["x"]]]}], "0"},
     {"0", 
      FractionBox[
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "a"}], "+", "c", "+", 
          SqrtBox["x"]}], 
         SqrtBox["x"]]], 
       SqrtBox["2"]], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "a"}], "+", "c", "-", 
          SqrtBox["x"]}], 
         SqrtBox["x"]]]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "a"}], "+", "c", "-", 
          SqrtBox["x"]}], 
         SqrtBox["x"]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.837604523069492*^9},
 CellLabel->
  "Out[98]//MatrixForm=",ExpressionUUID->"9bd2652d-71d5-41c3-b022-\
7f7e8205cb64"],

Cell[BoxData["\<\"Check the symplectic condition for an arbitrary choice of \
parameters\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045231116085`*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"ae01d1dc-0524-4303-8327-7f44e3b99b75"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1.`", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "0.9999999999999998`"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1.0000000000000002`"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1.0000000000000002`"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045231185904`*^9},
 CellLabel->
  "Out[100]//MatrixForm=",ExpressionUUID->"3ae488ef-3987-4c93-bb1c-\
dd78680a59fb"],

Cell[BoxData["\<\"Diagonalise the example covariance matrix for an arbitrary \
choice of parameters\"\>"], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.837604523126568*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"be002970-02dc-4adf-adc3-b68007b86af3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.8`", "0", "0", "0", "0", "0"},
     {"0", "3.8`", "0", "0", "0", "0"},
     {"0", "0", "5.9366656256505355`", "0", "0", "0"},
     {"0", "0", "0", "5.9366656256505355`", "0", "0"},
     {"0", "0", "0", "0", "4.736665625650534`", "0"},
     {"0", "0", "0", "0", "0", "4.736665625650534`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.831646538178726*^9, 3.8316465968067384`*^9, 
  3.8316468571371946`*^9, 3.8316491516156282`*^9, 3.8316496056711826`*^9, 
  3.831654811193967*^9, 3.8318114705933013`*^9, 3.8318120065111723`*^9, 
  3.831813001726019*^9, 3.832101502964856*^9, 3.8321643264973526`*^9, 
  3.832190843576541*^9, 3.8324467643576546`*^9, 3.8324547529517765`*^9, 
  3.8332843503463745`*^9, 3.833285519721652*^9, 3.833351922424436*^9, 
  3.8333529048942413`*^9, 3.8376045231335487`*^9},
 CellLabel->
  "Out[102]//MatrixForm=",ExpressionUUID->"cacd7a10-2278-4e3e-9611-\
1499c5ba7b08"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"\"\<Degenerate three mode example\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exampleDegenerate", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{
         FractionBox["a", "2"], "  ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{
         FractionBox["a", "2"], "  ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["a", "2"], "  ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{"a", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{
         FractionBox["a", "2"], " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["a", "2"], "  ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{
         FractionBox["a", "2"], " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{"a", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", "\"\<Covariance matrix\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"exampleDegenerate", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"Length", "[", "exampleDegenerate", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Symplectic eigenvalues\>\"", "\
\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"ToRadicals", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"I", " ", 
        RowBox[{
         RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
         "exampleDegenerate"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"2", "n"}], ";;", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", ">", "1"}], ",", 
     RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", "\"\<Similar 'perturbed' covariance matrix \
with non-degenerate symplectic eigenvalues\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exampleNonDegenerate", "=", 
   RowBox[{"exampleDegenerate", "+", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
      "\[Epsilon]", ",", "\[Epsilon]", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"exampleNonDegenerate", "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Symplectic eigenvalues of the \
perturbed covariance matrix\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sympEigs", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"ToRadicals", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"I", " ", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
           "exampleNonDegenerate"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"2", "n"}], ";;", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "1"}], ",", 
       RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "denominators", " ", "to", " ", "divide", " ", "the", 
    " ", "expressions", " ", "by"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denoms", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sympEigs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"Apply", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], "-", 
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "n"}], "]"}], ",", "i"}], "]"}]}], "}"}]}],
            "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "1"}], ",", 
       RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Substitution to simplify the expressions\
\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpRules", "=", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{
      RowBox[{"9", " ", 
       SuperscriptBox["a", "2"]}], "-", 
      RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}]}]}], "}"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Plus", " ", "or", " ", "minus", " ", "signs", " ", "for", " ", "each", 
    " ", "expression"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"signs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", "j"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"2", "n"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"We", " ", "calculate", " ", 
     SuperscriptBox[
      SubscriptBox["s", "4"], "*"], 
     SubscriptBox["s", "j"], " ", "rather", " ", "than", " ", 
     SuperscriptBox[
      SubscriptBox["s", "2"], "*"], 
     SubscriptBox["s", "j"], " ", "because", " ", 
     SubscriptBox["s", "2"]}], "=", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods1", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"exampleNonDegenerate", "-", 
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "I", " ", 
              RowBox[{"\[CapitalOmega]", "[", "n", "]"}]}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "4"}], "]"}], ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "i"}], "]"}]}], "]"}], 
           "]"}], "]"}], "/", 
         RowBox[{"denoms", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "//", "Chop"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"2", "n"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "1"}], ",", 
       RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"exampleNonDegenerate", "-", 
             RowBox[{
              RowBox[{"sympEigs", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", "I", " ", 
              RowBox[{"\[CapitalOmega]", "[", "n", "]"}]}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "4"}], "]"}], ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "i"}], "]"}]}], "]"}], 
           "]"}], "]"}], "/", 
         RowBox[{"denoms", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "//", "Chop"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"2", "n"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "1"}], ",", 
       RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prods3", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"exampleNonDegenerate", "-", 
              RowBox[{
               RowBox[{"sympEigs", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", "I", " ", 
               RowBox[{"\[CapitalOmega]", "[", "n", "]"}]}]}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "n"}]}], "]"}], ",", "6"}], "]"}], ",", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "n"}]}], "]"}], ",", "i"}], "]"}]}], "]"}], 
            "]"}], "]"}], "/", 
          RowBox[{"denoms", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "//", "Chop"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"2", "n"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", ">", "1"}], ",", 
        RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Simplifications", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "a"}], 
       SqrtBox["x"]]}], ",", 
     FractionBox["a", 
      SqrtBox["x"]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", 
          SqrtBox["x"], "-", 
          RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}], 
       RowBox[{"4", " ", 
        SqrtBox["x"]}]]}], ",", 
     FractionBox[
      RowBox[{"a", "+", 
       SqrtBox["x"], "-", 
       RowBox[{"2", " ", "\[Epsilon]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["x"]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", 
          SqrtBox["x"], "-", 
          RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}], 
       RowBox[{"4", " ", 
        SqrtBox["x"]}]]}], ",", 
     FractionBox[
      RowBox[{"a", "+", 
       SqrtBox["x"], "-", 
       RowBox[{"2", " ", "\[Epsilon]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["x"]}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prods3", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a"}], 
      SqrtBox["x"]], ",", 
     RowBox[{"-", 
      FractionBox["a", 
       SqrtBox["x"]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SqrtBox["x"], "+", 
          RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}], 
       RowBox[{"4", " ", 
        SqrtBox["x"]}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "a"}], "+", 
       SqrtBox["x"], "+", 
       RowBox[{"2", " ", "\[Epsilon]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["x"]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SqrtBox["x"], "+", 
          RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}], 
       RowBox[{"4", " ", 
        SqrtBox["x"]}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "a"}], "+", 
       SqrtBox["x"], "+", 
       RowBox[{"2", " ", "\[Epsilon]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["x"]}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals1", "=", 
   RowBox[{"prods1", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"prods1", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals2", "=", 
   RowBox[{"prods2", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"prods2", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vals3", "=", 
    RowBox[{"prods3", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"prods3", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Simplifications", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{
        SqrtBox["2"], 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", 
        SqrtBox["x"], "+", 
        RowBox[{"2", " ", "\[Epsilon]"}]}]], 
      RowBox[{
       SqrtBox["2"], 
       SuperscriptBox["x", 
        RowBox[{"1", "/", "4"}]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{"a", "+", 
          SqrtBox["x"], "-", 
          RowBox[{"2", " ", "\[Epsilon]"}]}]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     FractionBox[
      SqrtBox[
       RowBox[{"a", "+", 
        SqrtBox["x"], "-", 
        RowBox[{"2", " ", "\[Epsilon]"}]}]], 
      RowBox[{"2", " ", 
       SuperscriptBox["x", 
        RowBox[{"1", "/", "4"}]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{"a", "+", 
          SqrtBox["x"], "-", 
          RowBox[{"2", " ", "\[Epsilon]"}]}]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     FractionBox[
      SqrtBox[
       RowBox[{"a", "+", 
        SqrtBox["x"], "-", 
        RowBox[{"2", " ", "\[Epsilon]"}]}]], 
      RowBox[{"2", " ", 
       SuperscriptBox["x", 
        RowBox[{"1", "/", "4"}]]}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals3", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", 
       SqrtBox[
        RowBox[{"a", "+", 
         SqrtBox["x"], "-", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]]}], 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["x", 
        RowBox[{"1", "/", "4"}]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       SqrtBox[
        RowBox[{"a", "+", 
         SqrtBox["x"], "-", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{
        SqrtBox["2"], " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SqrtBox["x"], "+", 
          RowBox[{"2", " ", "\[Epsilon]"}]}]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", 
        SqrtBox["x"], "+", 
        RowBox[{"2", " ", "\[Epsilon]"}]}]], 
      RowBox[{"2", " ", 
       SuperscriptBox["x", 
        RowBox[{"1", "/", "4"}]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SqrtBox["x"], "+", 
          RowBox[{"2", " ", "\[Epsilon]"}]}]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", 
        SqrtBox["x"], "+", 
        RowBox[{"2", " ", "\[Epsilon]"}]}]], 
      RowBox[{"2", " ", 
       SuperscriptBox["x", 
        RowBox[{"1", "/", "4"}]]}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"signs", "*", "#"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"vals1", ",", "vals2", ",", "vals3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"vals", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "+", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vals", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"2", "j"}]}], "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Diagonalising symplectic for the \
perturbed covariance matrix\>\"", "\[IndentingNewLine]", 
 RowBox[{"S", "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Check the symplectic \
condition\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S", ".", 
       RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
       RowBox[{"Transpose", "[", "S", "]"}]}], "//.", "simpRules"}], ")"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Diagonalise the perturbed \
covariance matrix\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"S", ".", 
       RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
       "exampleNonDegenerate", ".", 
       RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
       RowBox[{"Transpose", "[", "S", "]"}]}]}], "//.", "simpRules"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", ">", "1"}], ",", 
      RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SDegenerate", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"S", "//.", "simpRules"}], ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"a", ">", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Limiting case of the diagonalising \
symplectic as the perturbation goes to 0\>\"", "\[IndentingNewLine]", 
 RowBox[{"SDegenerate", "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Check the symplectic \
condition\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SDegenerate", ".", 
   RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
   RowBox[{"Transpose", "[", "SDegenerate", "]"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", "\"\<Diagonalise the unperturbed \
covariance matrix\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{"SDegenerate", ".", 
     RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", "exampleDegenerate", 
     ".", 
     RowBox[{"\[CapitalOmega]", "[", "n", "]"}], ".", 
     RowBox[{"Transpose", "[", "SDegenerate", "]"}]}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.831649769472453*^9, 3.831649795806651*^9}, {
   3.8316498298374596`*^9, 3.8316498379208975`*^9}, {3.831649913811879*^9, 
   3.831650083953864*^9}, {3.831650124360222*^9, 3.8316501743592467`*^9}, {
   3.831650293663583*^9, 3.8316504148542204`*^9}, {3.831650716773302*^9, 
   3.831650739538712*^9}, {3.8316520318542576`*^9, 3.831652036659027*^9}, {
   3.831652481150863*^9, 3.8316524872759905`*^9}, {3.831653293322469*^9, 
   3.8316532991755466`*^9}, {3.83165377020063*^9, 3.8316537765416894`*^9}, {
   3.8316538177890673`*^9, 3.831653818729294*^9}, {3.83165386655192*^9, 
   3.831653897275528*^9}, {3.8316540814499865`*^9, 3.8316542120570946`*^9}, {
   3.831654272410014*^9, 3.8316542780725756`*^9}, 3.831654717052995*^9, 
   3.831654768225645*^9, {3.8316550339451575`*^9, 3.8316550382586856`*^9}, {
   3.831812189413931*^9, 3.8318121903114195`*^9}, {3.831812228666842*^9, 
   3.8318122723953753`*^9}, {3.8318123184362803`*^9, 
   3.8318124249973216`*^9}, {3.831812479887021*^9, 3.831812557626012*^9}, {
   3.8318126053578587`*^9, 3.831812615655086*^9}, {3.831812649615131*^9, 
   3.8318126679626894`*^9}, {3.8318127669131784`*^9, 
   3.8318128175405335`*^9}, {3.831812885365653*^9, 3.8318128925678444`*^9}, {
   3.83181292792334*^9, 3.8318129910524454`*^9}, {3.831826667929758*^9, 
   3.83182668869386*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"97d972f3-02d1-4eab-94b7-14ed63715c10"],

Cell[BoxData["\<\"Degenerate three mode example\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604523268511*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"4a2d0e0a-2bb2-4d8a-82c7-afc85304d5e5"],

Cell[BoxData["\<\"Covariance matrix\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604523278836*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"794a5ad0-aee4-4df6-beda-7255963d4bc9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", 
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"], "0"},
     {"0", "a", "0", 
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"]},
     {
      FractionBox["a", "2"], "0", "a", "0", 
      FractionBox["a", "2"], "0"},
     {"0", 
      FractionBox["a", "2"], "0", "a", "0", 
      FractionBox["a", "2"]},
     {
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"], "0", "a", "0"},
     {"0", 
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"], "0", "a"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045232877827`*^9},
 CellLabel->
  "Out[106]//MatrixForm=",ExpressionUUID->"9ee8c1f8-20a9-4ddf-82ae-\
0925a13deaad"],

Cell[BoxData["\<\"Symplectic eigenvalues\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045232977886`*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"85958892-b6a7-4ee7-9a2a-241dd0bc915c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "a"}], ",", 
   FractionBox["a", "2"], ",", 
   FractionBox["a", "2"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.83760452330577*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"7e0b938a-cb9d-4434-879a-84c75c88ca2b"],

Cell[BoxData["\<\"Similar 'perturbed' covariance matrix with non-degenerate \
symplectic eigenvalues\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045233137083`*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"0165bb4f-b048-4a71-b860-5591baf4e4e9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "+", "\[Epsilon]"}], "0", 
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"], "0"},
     {"0", 
      RowBox[{"a", "+", "\[Epsilon]"}], "0", 
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"]},
     {
      FractionBox["a", "2"], "0", "a", "0", 
      FractionBox["a", "2"], "0"},
     {"0", 
      FractionBox["a", "2"], "0", "a", "0", 
      FractionBox["a", "2"]},
     {
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"], "0", "a", "0"},
     {"0", 
      FractionBox["a", "2"], "0", 
      FractionBox["a", "2"], "0", "a"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604523323682*^9},
 CellLabel->
  "Out[112]//MatrixForm=",ExpressionUUID->"7f13bc0d-d1ce-42ad-b976-\
f9380718fa6c"],

Cell[BoxData["\<\"Symplectic eigenvalues of the perturbed covariance matrix\"\
\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604523333666*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"7bbb2003-bb76-4d56-bb5b-c3433ce0089d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["a", "2"], ",", 
   FractionBox[
    SqrtBox[
     RowBox[{
      RowBox[{"17", " ", 
       SuperscriptBox["a", "2"]}], "+", 
      RowBox[{"8", " ", "a", " ", "\[Epsilon]"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "+", 
      RowBox[{"5", " ", "a", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"9", " ", 
          SuperscriptBox["a", "2"]}], "-", 
         RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}]}]]}], "+", 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"9", " ", 
          SuperscriptBox["a", "2"]}], "-", 
         RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}]}]]}]}]], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SqrtBox[
     RowBox[{
      FractionBox[
       RowBox[{"17", " ", 
        SuperscriptBox["a", "2"]}], "2"], "+", 
      RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "-", 
      RowBox[{
       FractionBox["5", "2"], " ", "a", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"9", " ", 
          SuperscriptBox["a", "2"]}], "-", 
         RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}]}]]}], "-", 
      RowBox[{"\[Epsilon]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"9", " ", 
          SuperscriptBox["a", "2"]}], "-", 
         RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}]}]]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604523753533*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"1f9330e2-d7ef-4e21-ac62-79530d48efe3"],

Cell[BoxData["\<\"Substitution to simplify the expressions\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045263236585`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"0f21eb36-fe60-47b3-88f1-49ee08641ee9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{
    RowBox[{"9", " ", 
     SuperscriptBox["a", "2"]}], "-", 
    RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604526332675*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"e05852fe-305e-44cd-91e3-cb8d9c29bf0a"],

Cell[BoxData["\<\"Diagonalising symplectic for the perturbed covariance \
matrix\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604542810582*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"75347752-b2a4-44f1-8d4d-563d2e58382e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{
        SqrtBox["2"], " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{"a", "+", 
         SqrtBox["x"], "-", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{"a", "+", 
         SqrtBox["x"], "-", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0"},
     {"0", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{
        SqrtBox["2"], " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{"a", "+", 
         SqrtBox["x"], "-", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{"a", "+", 
         SqrtBox["x"], "-", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"a", "+", 
          SqrtBox["x"], "-", 
          RowBox[{"2", " ", "\[Epsilon]"}]}]], 
        RowBox[{
         SqrtBox["2"], " ", 
         SuperscriptBox["x", 
          RowBox[{"1", "/", "4"}]]}]]}], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"a", "+", 
          SqrtBox["x"], "-", 
          RowBox[{"2", " ", "\[Epsilon]"}]}]], 
        RowBox[{
         SqrtBox["2"], " ", 
         SuperscriptBox["x", 
          RowBox[{"1", "/", "4"}]]}]]}], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SqrtBox["x"], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}]], 
       RowBox[{"2", " ", 
        SuperscriptBox["x", 
         RowBox[{"1", "/", "4"}]]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045428255424`*^9},
 CellLabel->
  "Out[132]//MatrixForm=",ExpressionUUID->"e71c58ba-32b6-4252-85b8-\
88e856605b48"],

Cell[BoxData["\<\"Check the symplectic condition\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604542857458*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"3814ab03-b49b-40b6-bc16-77177c262cec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045428644753`*^9},
 CellLabel->
  "Out[134]//MatrixForm=",ExpressionUUID->"6b21d308-a8a1-4ebb-9112-\
766de4297c6e"],

Cell[BoxData["\<\"Diagonalise the perturbed covariance matrix\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604542873415*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"7c534cda-110d-4fd5-9c81-c45ebf4dd189"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["a", "2"], "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["a", "2"], "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", "a"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{"9", " ", 
            SuperscriptBox["a", "2"]}], "-", 
           RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Epsilon]", "2"]}]}]]}], ")"}]}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", "a"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{"9", " ", 
            SuperscriptBox["a", "2"]}], "-", 
           RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Epsilon]", "2"]}]}]]}], ")"}]}], "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", "a"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}], "-", 
         SqrtBox[
          RowBox[{
           RowBox[{"9", " ", 
            SuperscriptBox["a", "2"]}], "-", 
           RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Epsilon]", "2"]}]}]]}], ")"}]}], "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", "a"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}], "-", 
         SqrtBox[
          RowBox[{
           RowBox[{"9", " ", 
            SuperscriptBox["a", "2"]}], "-", 
           RowBox[{"4", " ", "a", " ", "\[Epsilon]"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Epsilon]", "2"]}]}]]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604543045952*^9},
 CellLabel->
  "Out[136]//MatrixForm=",ExpressionUUID->"439c20d9-91d5-4500-a5c9-\
c62477bfbf6a"],

Cell[BoxData["\<\"Limiting case of the diagonalising symplectic as the \
perturbation goes to 0\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045456485405`*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"54165512-2fce-4fba-aa67-428ee9a7a988"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]},
     {
      FractionBox["1", 
       SqrtBox["3"]], "0", 
      FractionBox["1", 
       SqrtBox["3"]], "0", 
      FractionBox["1", 
       SqrtBox["3"]], "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["3"]], "0", 
      FractionBox["1", 
       SqrtBox["3"]], "0", 
      FractionBox["1", 
       SqrtBox["3"]]},
     {
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], "0", 
      FractionBox["1", 
       SqrtBox["6"]], "0", 
      FractionBox["1", 
       SqrtBox["6"]], "0"},
     {"0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], "0", 
      FractionBox["1", 
       SqrtBox["6"]], "0", 
      FractionBox["1", 
       SqrtBox["6"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045456588807`*^9},
 CellLabel->
  "Out[139]//MatrixForm=",ExpressionUUID->"7afc15a5-5803-43f8-87b7-\
66268ba0e4d9"],

Cell[BoxData["\<\"Check the symplectic condition\"\>"], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604545676262*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"565dcee7-2727-4025-a6ec-b9fec733c4f8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045456832848`*^9},
 CellLabel->
  "Out[141]//MatrixForm=",ExpressionUUID->"f4970d5d-6974-46fa-9986-\
78a061ce87c9"],

Cell[BoxData["\<\"Diagonalise the unperturbed covariance matrix\"\>"], \
"Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.8376045456902237`*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"a60f6eab-f2c7-4512-bb06-5cbf8dfd710e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["a", "2"], "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["a", "2"], "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"2", " ", "a"}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"2", " ", "a"}], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["a", "2"], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["a", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831649846002658*^9, 3.831649937980584*^9, {3.831650026975602*^9, 
   3.8316500844818125`*^9}, {3.831650141820467*^9, 3.8316501799374094`*^9}, 
   3.8316504210857544`*^9, 3.8316524941029754`*^9, 3.831653900245199*^9, 
   3.8316542125122204`*^9, 3.831654291210287*^9, 3.8316547215218887`*^9, 
   3.831654770251904*^9, 3.8316550395391617`*^9, 3.831811487093581*^9, 
   3.831812015884121*^9, 3.8318130095287704`*^9, 3.8318266897487235`*^9, 
   3.832101518487864*^9, 3.8321643372466087`*^9, 3.832190857312872*^9, 
   3.8324467777820473`*^9, 3.8324547639122815`*^9, 3.833284363813761*^9, 
   3.8332855348974643`*^9, 3.83335193456812*^9, 3.833352910992948*^9, 
   3.837604545697217*^9},
 CellLabel->
  "Out[143]//MatrixForm=",ExpressionUUID->"fd2d7c39-93f8-47a8-8985-\
26e0cd6d72e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Compare", " ", "the", " ", "two", " ", "methods", " ", "numerically", " ",
     "and", " ", "analytically"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "=", "60"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Generate", " ", "a", " ", "random"}], ",", " ", "positive", ",",
      " ", 
     RowBox[{"symmetric", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", "d"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "q", "]"}], ".", "q"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Find", " ", "the", " ", "diagonalising", " ", "symplectic", " ", "via", 
     " ", "two", " ", "different", " ", "methods"}], "*)"}], 
   "\[IndentingNewLine]", "\"\<Timings for numerical covariance matrices\>\"",
    "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"Snew", "=", 
      RowBox[{"FindDiagonalisingSymplectic", "[", "V", "]"}]}], ";"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"Sold", "=", 
      RowBox[{"FindDiagonalisingSymplecticOldMethod", "[", "V", "]"}]}], 
     ";"}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\"\<Verify that the calculated symplectic (new method) gives the thermal \
decomposition.\>\"", "\[IndentingNewLine]", 
   RowBox[{"Wnew", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Snew", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", "V", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", 
        RowBox[{"Transpose", "[", "Snew", "]"}]}]}], "//", "Chop"}], "]"}]}], 
   "\[IndentingNewLine]", 
   "\"\<Verify that the calculated symplectic (old method) gives the thermal \
decomposition.\>\"", "\[IndentingNewLine]", 
   RowBox[{"Wold", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sold", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", "V", ".", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", 
        RowBox[{"Transpose", "[", "Sold", "]"}]}]}], "//", "Chop"}], "]"}]}], 
   "\[IndentingNewLine]", "\"\<Verify that these are the same.\>\"", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"Diagonal", "[", "Wnew", "]"}], "]"}], "]"}], "-", 
        RowBox[{"Sort", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"Diagonal", "[", "Wold", "]"}], "]"}], "]"}]}], "//", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"#", ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}], "]"}], "&"}]}], "]"}], "]"}], 
    "\[Equal]", "0"}], "\[IndentingNewLine]", 
   "\"\<Check the symplectic condition (new method)\>\"", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Snew", ".", 
         RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", 
         RowBox[{"Transpose", "[", "Snew", "]"}]}], "-", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}]}], "//", "Chop"}], "]"}], 
     "]"}], "\[Equal]", "0"}], "\[IndentingNewLine]", 
   "\"\<Check the symplectic condition (old method)\>\"", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sold", ".", 
         RowBox[{"\[CapitalOmega]", "[", "d", "]"}], ".", 
         RowBox[{"Transpose", "[", "Sold", "]"}]}], "-", 
        RowBox[{"\[CapitalOmega]", "[", "d", "]"}]}], "//", "Chop"}], "]"}], 
     "]"}], "\[Equal]", "0"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\"\<Timings for covariance matrices parametrised by analytical \
variables\>\"", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Find", " ", "the", " ", "diagonalising", " ", "symplectic", " ", "via", 
     " ", "two", " ", "different", " ", "methods"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"FindDiagonalisingSymplectic", "[", "exampleTwoMode", "]"}], 
     ";"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{
     "FindDiagonalisingSymplecticOldMethod", "[", "exampleTwoMode", "]"}], 
     ";"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.832189395379156*^9, 3.83218939693509*^9}, {
   3.832189436128888*^9, 3.8321894435285597`*^9}, {3.8321896006701117`*^9, 
   3.8321898385106726`*^9}, {3.8321906197290163`*^9, 3.832190718555964*^9}, {
   3.832190753266178*^9, 3.832190779449627*^9}, {3.8324539257300625`*^9, 
   3.8324539308830347`*^9}, {3.8324540126343603`*^9, 3.832454136332898*^9}, {
   3.832454293555281*^9, 3.83245435284969*^9}, 3.832454670452675*^9, {
   3.832454702043899*^9, 3.832454707982979*^9}, 3.833352874854082*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"41799b29-e124-4aba-8bbf-6dc55633e0c8"],

Cell[BoxData["\<\"Timings for numerical covariance matrices\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045459470882`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"ba1cc904-2fb2-47b9-8feb-38be3aad8237"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.796875`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.837604549978079*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"3b20be40-6269-409d-be00-07f410f5f6be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0625`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045502513475`*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"aa585af8-ac76-4b83-9232-14c7d2dc2517"],

Cell[BoxData["\<\"Verify that the calculated symplectic (new method) gives \
the thermal decomposition.\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.837604550257331*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"14539c95-541f-493b-be40-5cf0dd3b43d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJzt1ltM02ccxnFI1RlQoxKcqJB1mQdCLVhUlFifWEsowcaAGBsw0IAwtYKn
eohnkREj8TRFJ8NDoaKhVRpFhOE250WdmZRWsGDHoYVS/qUcNsDNU8Ut2UUv
d/le/C7e5JfP1XPxvXj5mduTs3l+fn5h/71/79h99eklX5pQGl1WHfOmGVwZ
vzupsg/k5Cx7XVFUXF01h9b4W3cPXRrAM0Xux4zXQ8ztJCf39bBIbXqe3gW7
ZFi64Wg/jgn/Ns63UbfkbPtWvV5/UuNEbI139vMcD8r8F995/hN1S862Ly0V
/bIqohv+1bMeeq/2YckPys+W6ahbcrZdVCRuO3DYgUeLJhzZ/NCNil5r0KOL
1C052144WlCrC7CjRLhz894/OCxfNtK5/jh1S86225aMbwgub4fL0FazV8ZB
POFa5OgO6pacbZ8cKsi6orJhLPDNtjOqXsiMTU+2pFG35Gz7vFk3NyrRCo2g
VqywurAxM2dS+xrqlpxtb16dkFIzzooGL+QSsQv8LyI1Q2Lqlpxt57ZGyOuM
TcibmxwkK+9B7faUEY+QuiVn211cmGCi/wsYRt9dHhp2gqc6xzcGULfkbHs+
r322qMkC3dvY+9+tdWJLXke+2jjI3E5ycl8Pt59Wi65bsHKOzJt4qRtto6lH
RvZTt+RsO6csOmjOsyDZ8c0Hh7sLIudYtDWKuiVn29UXN8UUSywQxE3zStZ0
YWlulp0bHGBuJzm5r+cqtaEI+uefcOf42QvlDrjn7XqVepu6JWfbK3O+LtS5
zNi0It1cN84B0y6e3Z1N3ZKz7fdCvTnltWZMKV100qC0w928TivnU7fkbPv6
KQtzS8+Z4QlSOUO0nVCF3yzU9vQzt5Oc3Ndf96mH4lVmjCX91RFY0gGRwnLB
7y51S862G2zTuwIlZgwkPnWEq9uRELPv11M7qFtytv1enE4bEGLG/rQPkz1r
2yCdOaliWzR1S862FxgPFwl6GyHl2V68lf4OnXRYeOW9h7md5OS+PvWlfmW9
phH3Kw3nT8htqOrrqGh9St2Ss+1f7Y74fJWiERmyPQZ9/CsUV/2cOeM8dUvO
tnMHzyb9FtyIelu9vCW1FQ+mX+08k0HdkrPtVdMSv5c2mNAzKPozS9GC7MdZ
E/PDqVtytv1HdY8w5VsTHls0N9IKrQhZ3JtZ7GVvJzm5r4f2By9o2mBCQVRL
vP3BS4xPmPvkvYW9neTk/8c/AZADiwM=
              "], {{0, 0}, {30, 30}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["120", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"120", ",", "120"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJzt1ltM02ccxnFI1RlQoxKcqJB1mQdCLVhUlFifWEsowcaAGBsw0IAwtYKn
eohnkREj8TRFJ8NDoaKhVRpFhOE250WdmZRWsGDHoYVS/qUcNsDNU8Ut2UUv
d/le/C7e5JfP1XPxvXj5mduTs3l+fn5h/71/79h99eklX5pQGl1WHfOmGVwZ
vzupsg/k5Cx7XVFUXF01h9b4W3cPXRrAM0Xux4zXQ8ztJCf39bBIbXqe3gW7
ZFi64Wg/jgn/Ns63UbfkbPtWvV5/UuNEbI139vMcD8r8F995/hN1S862Ly0V
/bIqohv+1bMeeq/2YckPys+W6ahbcrZdVCRuO3DYgUeLJhzZ/NCNil5r0KOL
1C052144WlCrC7CjRLhz894/OCxfNtK5/jh1S86225aMbwgub4fL0FazV8ZB
POFa5OgO6pacbZ8cKsi6orJhLPDNtjOqXsiMTU+2pFG35Gz7vFk3NyrRCo2g
VqywurAxM2dS+xrqlpxtb16dkFIzzooGL+QSsQv8LyI1Q2Lqlpxt57ZGyOuM
TcibmxwkK+9B7faUEY+QuiVn211cmGCi/wsYRt9dHhp2gqc6xzcGULfkbHs+
r322qMkC3dvY+9+tdWJLXke+2jjI3E5ycl8Pt59Wi65bsHKOzJt4qRtto6lH
RvZTt+RsO6csOmjOsyDZ8c0Hh7sLIudYtDWKuiVn29UXN8UUSywQxE3zStZ0
YWlulp0bHGBuJzm5r+cqtaEI+uefcOf42QvlDrjn7XqVepu6JWfbK3O+LtS5
zNi0It1cN84B0y6e3Z1N3ZKz7fdCvTnltWZMKV100qC0w928TivnU7fkbPv6
KQtzS8+Z4QlSOUO0nVCF3yzU9vQzt5Oc3Ndf96mH4lVmjCX91RFY0gGRwnLB
7y51S862G2zTuwIlZgwkPnWEq9uRELPv11M7qFtytv1enE4bEGLG/rQPkz1r
2yCdOaliWzR1S862FxgPFwl6GyHl2V68lf4OnXRYeOW9h7md5OS+PvWlfmW9
phH3Kw3nT8htqOrrqGh9St2Ss+1f7Y74fJWiERmyPQZ9/CsUV/2cOeM8dUvO
tnMHzyb9FtyIelu9vCW1FQ+mX+08k0HdkrPtVdMSv5c2mNAzKPozS9GC7MdZ
E/PDqVtytv1HdY8w5VsTHls0N9IKrQhZ3JtZ7GVvJzm5r4f2By9o2mBCQVRL
vP3BS4xPmPvkvYW9neTk/8c/AZADiwM=
              "], {{0, 0}, {30, 30}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["120", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"120", ",", "120"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.008333333333333333`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.00861123940000366`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.00861123939999055`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.2356018971099687`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.23560189710992394`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {120, 120}, 0, {
   1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
     20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 
     38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 
     56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 
     74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
     92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 
     108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120}, {{1}, {
     2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
     15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {
     27}, {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {
     39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {
     51}, {52}, {53}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {
     63}, {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {
     75}, {76}, {77}, {78}, {79}, {80}, {81}, {82}, {83}, {84}, {85}, {86}, {
     87}, {88}, {89}, {90}, {91}, {92}, {93}, {94}, {95}, {96}, {97}, {98}, {
     99}, {100}, {101}, {102}, {103}, {104}, {105}, {106}, {107}, {108}, {
     109}, {110}, {111}, {112}, {113}, {114}, {115}, {116}, {117}, {118}, {
     119}, {120}}}, CompressedData["
1:eJw1xW0wkwEcAPDNay4+2HC0iFptolgcjbPnj1E2a42NOzGZUKO4cul0s7ju
FLmkl2NhKuS4q27ReekDwilnyRG77py7YtObuV6ma+vq7vn34Xe/AEVxSh6V
QqFc+Ee8rreO3a8kXr0hP0lc/BHG1hMMLvnHoofN79YWiQI8q2kslDNtJGQa
8tm2ZGVc8GdCqiXPlBStR/h+I6pxffTymUAJFYbwhhuZtc2eDuD2/90eYqcV
Z/jCJCdyzBPdClcQ4JL0BFqrvTtk4N27XFStNjok4SIfeS4/3hO+epNvrFhp
7AfeQFslfxal9veJYYAAH/aSLfdw/UCJz1omnN3LAuAlPr79em7Q5E5IwW9d
Ui+c+smEFvypxlGkWNsDNbhjN3/De4kFsXiPs6hUPBgIhbhy5PR0qTAI5ofJ
7yqPm++l7QMDnmonsO41h8AclVwbvWmySTnQjw9N2W9rN3NgHn876NV61RYG
BnzmUFta72Y4iHBmRQbNKT4C/HEPuwVxliUCXlDJ17JXS0yvD8InXNNZ/Ec3
wIXb+FLgVHllczT04fP1K0a6IgZ68ZvqgiZKHg+68MRcaad8gAA6LpxxsYxW
AJzFw92YhVW2WEjAdS2+PFV2HERqybMll6s7iHjg4o/8GDuO6fgwhNd87zSp
kxOgAt9ghRivhyZCFJuco/jgRJtJhDv4+0g7B4PrYZjD+XEsVT9bAOF4Q09j
XWOYEOQ4T1vHzC9Phv14sGb9QBJdBBz8GqtvekJ/BK7gOcIRjo55FPLxEtlg
loohgXN4taG+jLcqgXy8VmnpsualQDHeXsX8lVmYCk9w10XT5AmjFIwL5I9H
f1NDzsvgOS7fumgd35IOZXhHbEBojCEdWvC/MImfeA==
    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045508478727`*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"c575703d-4dbd-43e3-8f3f-eaacda6b1592"],

Cell[BoxData["\<\"Verify that the calculated symplectic (old method) gives \
the thermal decomposition.\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045508787885`*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"7d151882-cca1-4bc6-b3b2-60585f96a975"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJzt0t1P03cYxuEqCgzUBAg6YZrVyByjFgYmGDe4A8MVp41hYGxwqV2ZTFfw
hXW6qLjgtFGbiYiiomwitRKpDKNDGtQxE+uWIe1PWKkdpS0UKJQXAV8HhWXJ
DvonfE2egyd5ch3dBx++fMenW/x4PN7i/++/f9WeRmn5khZcSLh0M/FlG9yX
+N0ZVwdATs6y8wfD323d2IKSuHaR45e/ELgm6t4Ex95OcnJfr1f2CLNOtkDL
VV7cpDIjbEWf/LSXvZ3k5L6uDVl7Pu1hC+4Px4/mSNohbcoJPBjtYW4nObmv
t+0rzvgz3IgCa6O4PdsCbWiF/fhm6pacbX/j65gFKRIjpkXf1OlEj1H086/y
+SXULTnb7mnTJTdWGhF3ta7ke7EVpQOdWssD6pacbT9sKFQL+oz42M/66FXa
39CljQnPTVC35Gx7xeoaTdBCE7qyJ+d61ncg6s052ryEQeZ2kpP7erE1tCs4
1YTpTx44o5U2LEjc8/uxndQtOdv+ZEA5IlKYYM943hlc3okYCVfKq6Vuydl2
wbzl+RdOmHA/VOFaqLFjefRllaaHuiVn2wsXeXOrGkzIPP/+kTqZA+VtmRox
f4i5neTkvl6d+6WqptcE6YdSk36WE80Ffo7+LdQtOdseJdMsQhiHZF1RcWmV
E4XvFDzOrqZuydn2Gae+SDydyuHkRyHe1HVdUOflONzD1C052x7wuXqfaTuH
JufhSWd/F2Su6QRz3DBzO8nJff2O/Qdl/E8c7kSke9eWdeODp9kHxr+lbsnZ
9qGZtsj4Vg5nX6y6cXa9C+r8zoNKA3VLzra/5V4sCJzxCM7Rf86MjLlg3naC
bwgaYW4nObmvy43vifWGVtRPZISlV/XgiiJr3COkbsnZdifWZNXPMuPuJMSp
Sb0IeDu2ciSJuiVn280Rlz+TwQJO0JAkMfdCJs+dY1tH3ZKz7UcjBTnnFFac
CX6Zd1zRh2RD671tm6hbcra9STj7YXiVDVO1HfW7092Y6/9j7NOd1C05264a
PdRQE+TAlGDX1t1P3AhZOW7fUETdkrPtNlVSx95CJ76K9T+w9VY/8vrMYbdP
UbfkbHt1WfxvKTHd8L8ecctbMQCPXhawsoa6JWfbMyt0uiOVLiyp9UY253pg
4a241nyXuiVn27tjNNLtul4sTRlL2/jdILKELwzLrNQtOduuV8et1t90wyK6
Uru/bAh/SPKnNj+jbslfT/8XnfuNBw==
              "], {{0, 0}, {30, 30}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["120", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"120", ",", "120"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJzt0t1P03cYxuEqCgzUBAg6YZrVyByjFgYmGDe4A8MVp41hYGxwqV2ZTFfw
hXW6qLjgtFGbiYiiomwitRKpDKNDGtQxE+uWIe1PWKkdpS0UKJQXAV8HhWXJ
DvonfE2egyd5ch3dBx++fMenW/x4PN7i/++/f9WeRmn5khZcSLh0M/FlG9yX
+N0ZVwdATs6y8wfD323d2IKSuHaR45e/ELgm6t4Ex95OcnJfr1f2CLNOtkDL
VV7cpDIjbEWf/LSXvZ3k5L6uDVl7Pu1hC+4Px4/mSNohbcoJPBjtYW4nObmv
t+0rzvgz3IgCa6O4PdsCbWiF/fhm6pacbX/j65gFKRIjpkXf1OlEj1H086/y
+SXULTnb7mnTJTdWGhF3ta7ke7EVpQOdWssD6pacbT9sKFQL+oz42M/66FXa
39CljQnPTVC35Gx7xeoaTdBCE7qyJ+d61ncg6s052ryEQeZ2kpP7erE1tCs4
1YTpTx44o5U2LEjc8/uxndQtOdv+ZEA5IlKYYM943hlc3okYCVfKq6Vuydl2
wbzl+RdOmHA/VOFaqLFjefRllaaHuiVn2wsXeXOrGkzIPP/+kTqZA+VtmRox
f4i5neTkvl6d+6WqptcE6YdSk36WE80Ffo7+LdQtOdseJdMsQhiHZF1RcWmV
E4XvFDzOrqZuydn2Gae+SDydyuHkRyHe1HVdUOflONzD1C052x7wuXqfaTuH
JufhSWd/F2Su6QRz3DBzO8nJff2O/Qdl/E8c7kSke9eWdeODp9kHxr+lbsnZ
9qGZtsj4Vg5nX6y6cXa9C+r8zoNKA3VLzra/5V4sCJzxCM7Rf86MjLlg3naC
bwgaYW4nObmvy43vifWGVtRPZISlV/XgiiJr3COkbsnZdifWZNXPMuPuJMSp
Sb0IeDu2ciSJuiVn280Rlz+TwQJO0JAkMfdCJs+dY1tH3ZKz7UcjBTnnFFac
CX6Zd1zRh2RD671tm6hbcra9STj7YXiVDVO1HfW7092Y6/9j7NOd1C05264a
PdRQE+TAlGDX1t1P3AhZOW7fUETdkrPtNlVSx95CJ76K9T+w9VY/8vrMYbdP
UbfkbHt1WfxvKTHd8L8ecctbMQCPXhawsoa6JWfbMyt0uiOVLiyp9UY253pg
4a241nyXuiVn27tjNNLtul4sTRlL2/jdILKELwzLrNQtOduuV8et1t90wyK6
Uru/bAh/SPKnNj+jbslfT/8XnfuNBw==
              "], {{0, 0}, {30, 30}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["120", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"120", ",", "120"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.008333333333333333`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "95.39435961958154`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "95.39435961958117`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "92.13708420854888`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "92.13708420854877`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {120, 120}, 0, {
   1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
     20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 
     38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 
     56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 
     74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
     92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 
     108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120}, {{1}, {
     2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
     15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {
     27}, {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {
     39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {
     51}, {52}, {53}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {
     63}, {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {
     75}, {76}, {77}, {78}, {79}, {80}, {81}, {82}, {83}, {84}, {85}, {86}, {
     87}, {88}, {89}, {90}, {91}, {92}, {93}, {94}, {95}, {96}, {97}, {98}, {
     99}, {100}, {101}, {102}, {103}, {104}, {105}, {106}, {107}, {108}, {
     109}, {110}, {111}, {112}, {113}, {114}, {115}, {116}, {117}, {118}, {
     119}, {120}}}, CompressedData["
1:eJw9xW0s1AEcAODz0qFs5s4Z3eRON6/JSV1od/fjZHEcx2F5reNYhGxypV2m
2tRMrLcxnJSw5EPCYmtL6VLtjkUh62YVd6rNpXHi7tT6/+rDs4cpLU2SWZFI
pDN/aLhMNnc2DfpxC2PG9MI+DdZwt5ebVkEVKeCIz8zqx/J0EiB/IO6rZf3K
LEqGCVweaew2yZKgGX/0vkHOWxTDZ7xHMpyloIvhNS6KHQnuYyVCHp7vM6BW
aUTQhi81L++LocaDBXdqr2PlV8aBAH/Y21jXGCKEkX/zfBSPfWNhCy8+YG07
63gEmvGPZV/IlIloWMc1B4N09exomMbZxk59VdxhEOHPPemeGX1RoMJLky/V
3OMLoBV30dJ5ipxI8Mbtt7OKLpgjwOJA3DzqYHx2HmAQHzgu6cwe4sMkvuN0
QRNJxgNv/GLdgo4q5YIc9/J/U1ndcghK8W9tpZa+oTCYw8PTF0/px0NBjG8y
phOyjBxwZRJfLkmnkAUcUOKJwtup/ev7IR+fHHJVXjGHwBZ+9JXNzg5DMNzA
NcJ1vVkSDFM4cyPG5G8IAgZeUXDM0J4aCBk452mxulwYADL8un18ecKwH7Ti
TV1RP9y0Pv+3fbAtXrrkDR74WUXV9Ik1FtzEe+n1uQFjXnAL31hV2TnLmUBb
I9ZSU+Z7wnaBGS/kVTHcuXTIwbs+mSi+d91Ai68EZudGCWhA20tcw3RQKM1U
6MZ3pxymKG2cIRx/l21Q3Zc6wjXciemSQF6wA3d85WpmbQvNFqbwnND5Ej+x
FYzjX0UnlzkeP/nWicSVTXGFkXu+81cbiWMaRtnBah1/Ge+QdbXMLc3w1XnE
T7jnVkN8NfwIf+LBsrem0TvVfOr41N9/A5zkpZI=
    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045508947477`*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"8511a4aa-27a3-46d0-97bc-20f64735d6fb"],

Cell[BoxData["\<\"Verify that these are the same.\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.837604550908717*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"f70391f0-6dda-431e-a39f-e12e280eed8a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045509147034`*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"c1aff182-ed08-462d-bcb6-c5bfb0c43a4b"],

Cell[BoxData["\<\"Check the symplectic condition (new method)\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045509226723`*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"0d23bdf4-6be4-4cb2-9630-35888455aba6"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045509306517`*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"70174d7d-1cd8-40da-a394-c636daba83d8"],

Cell[BoxData["\<\"Check the symplectic condition (old method)\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045509376335`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"4e9c8bd5-3608-402c-8746-cd200c2d70c8"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.837604550945609*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"74676b47-0c7c-433f-9c6f-55af928acc46"],

Cell[BoxData["\<\"Timings for covariance matrices parametrised by analytical \
variables\"\>"], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045509525914`*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"98088130-a842-4c53-a9e0-8b35edf11b49"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.03125`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045509595723`*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"80f64ec7-1224-4c05-bd19-2d1359d516af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.734375`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.8321897504005766`*^9, 3.8321898429994164`*^9}, 
   3.83219079603446*^9, 3.832190882378481*^9, 3.8324468034627705`*^9, 
   3.83245328662513*^9, 3.832454355342308*^9, 3.8324547098648033`*^9, 
   3.8324547901167097`*^9, 3.833284385811248*^9, 3.833285567779441*^9, 
   3.833351959060017*^9, 3.833352877526638*^9, 3.833352919848915*^9, 
   3.8376045692676477`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"19d1ca70-5291-4897-99db-1543f3a3b8af"]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1327, 25, 430, "Text",ExpressionUUID->"566665cc-06ca-4988-983a-7c0d37124ddb"],
Cell[1888, 47, 219, 3, 28, "Input",ExpressionUUID->"96035529-c088-47d6-be94-3f455e14dfd6"],
Cell[2110, 52, 13403, 364, 447, "Input",ExpressionUUID->"10d2eec8-d24a-42e1-bb0d-198b312ac8ac"],
Cell[CellGroupData[{
Cell[15538, 420, 3852, 98, 409, "Input",ExpressionUUID->"54f4b8cd-19a2-412d-a351-ee7ed75db43a"],
Cell[19393, 520, 1207, 17, 32, "Output",ExpressionUUID->"5ad2d0d7-3b1f-4837-9f69-be115a77e8db"],
Cell[20603, 539, 10920, 217, 300, "Output",ExpressionUUID->"221432e7-d431-458f-92c5-3d167d80b302"],
Cell[31526, 758, 1217, 17, 32, "Output",ExpressionUUID->"d421243c-d4c1-4eef-aa77-c090f06c8681"],
Cell[32746, 777, 10529, 197, 300, "Output",ExpressionUUID->"23a368cf-d43a-4d72-a53d-062c9e67220e"],
Cell[43278, 976, 1262, 18, 32, "Output",ExpressionUUID->"1d3576e9-9b38-4877-a3db-09e8f03c2d5e"],
Cell[44543, 996, 1185, 17, 32, "Output",ExpressionUUID->"7afa6902-79ee-4380-a600-ffb4581804d1"],
Cell[45731, 1015, 1261, 18, 32, "Output",ExpressionUUID->"c609aa1d-a02b-45f6-91ec-7d5572ab10c2"],
Cell[46995, 1035, 3503, 66, 300, "Output",ExpressionUUID->"6eb5c1c3-315b-44cf-83f2-fb0e227b1d3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50535, 1106, 29142, 909, 1356, "Input",ExpressionUUID->"f190226c-745c-4888-a4b8-b9c06906695c"],
Cell[79680, 2017, 1493, 21, 32, "Output",ExpressionUUID->"24bb6b30-4cac-4ce9-ac99-f0346be38734"],
Cell[81176, 2040, 1492, 21, 32, "Output",ExpressionUUID->"e8bd9246-42e5-4870-aacd-b309abfc8074"],
Cell[82671, 2063, 2160, 44, 96, "Output",ExpressionUUID->"2feb68aa-319e-400f-9b59-bd0287f74afa"],
Cell[84834, 2109, 1499, 21, 32, "Output",ExpressionUUID->"bd8277e1-3173-41a0-95df-f6a38f621a03"],
Cell[86336, 2132, 3085, 73, 90, "Output",ExpressionUUID->"577f61ae-c2ae-466c-9de0-80c2149dd225"],
Cell[89424, 2207, 1495, 21, 32, "Output",ExpressionUUID->"d7bb3da7-4252-49a7-b748-9a0d64dc9f23"],
Cell[90922, 2230, 1783, 34, 55, "Output",ExpressionUUID->"cc88b3ff-e9aa-4684-8fdb-75cfa3eb6426"],
Cell[92708, 2266, 1496, 21, 32, "Output",ExpressionUUID->"b39897fa-fc0b-40e2-b5d8-093e2c12e20c"],
Cell[94207, 2289, 1680, 30, 55, "Output",ExpressionUUID->"e10d4526-49dd-4871-b4bd-c727086ff0ca"],
Cell[95890, 2321, 1682, 30, 55, "Output",ExpressionUUID->"4fb58d7e-ddbb-4c68-ac91-c0805ee5b3c5"],
Cell[97575, 2353, 1492, 21, 32, "Output",ExpressionUUID->"d4d40eaa-ce84-417c-ae04-31a70bcb9fee"],
Cell[99070, 2376, 2286, 47, 79, "Output",ExpressionUUID->"570dc411-c4c2-4036-bbca-046f951acfef"],
Cell[101359, 2425, 1688, 28, 36, "Output",ExpressionUUID->"8e7bc0b1-12b7-4ab1-88b8-5eb5d0d4bedf"],
Cell[103050, 2455, 2193, 44, 79, "Output",ExpressionUUID->"1747ba65-59ce-4c64-a644-48187b59e6af"],
Cell[105246, 2501, 1706, 30, 32, "Output",ExpressionUUID->"bf2f0dfd-8cd0-475a-8f2a-80f05dc41ab1"],
Cell[106955, 2533, 2238, 46, 79, "Output",ExpressionUUID->"1b3b5484-17d7-4df8-9693-54ad0e096ed8"],
Cell[109196, 2581, 1598, 25, 32, "Output",ExpressionUUID->"3d8a2125-b7a4-4ae0-bfe8-cdc47807f6d8"],
Cell[110797, 2608, 2217, 45, 79, "Output",ExpressionUUID->"492fd20b-298a-40b9-89f1-d63732d59eed"],
Cell[113017, 2655, 1672, 29, 36, "Output",ExpressionUUID->"056b6533-2368-47dd-bb67-7dea78ed9ca4"],
Cell[114692, 2686, 2240, 46, 79, "Output",ExpressionUUID->"7727df5e-9d42-4c6b-bb41-a8cf06ba51f2"],
Cell[116935, 2734, 1578, 24, 32, "Output",ExpressionUUID->"f314aa33-d0a7-4be9-8ea1-2f81902acf17"],
Cell[118516, 2760, 2217, 45, 79, "Output",ExpressionUUID->"73044a29-2677-40a1-8d30-70f705edb797"],
Cell[120736, 2807, 1672, 29, 36, "Output",ExpressionUUID->"94885fb5-31b2-4c32-b09f-ed98b562ef07"],
Cell[122411, 2838, 2286, 47, 79, "Output",ExpressionUUID->"a2ed4267-2f71-4108-a7e4-fdf5776f6d30"],
Cell[124700, 2887, 1685, 28, 36, "Output",ExpressionUUID->"b252351d-0ece-462d-9301-bf78cbe5c877"],
Cell[126388, 2917, 2193, 44, 79, "Output",ExpressionUUID->"8d12c012-e70b-4c8c-a659-8fdf432486f4"],
Cell[128584, 2963, 1653, 28, 32, "Output",ExpressionUUID->"62c6f485-8fc3-4f49-bf65-a3bb5f45e615"],
Cell[130240, 2993, 1500, 21, 32, "Output",ExpressionUUID->"dd3281ec-a616-41ed-94d3-b8b5201f10bf"],
Cell[131743, 3016, 2027, 42, 71, "Output",ExpressionUUID->"c8e814f4-b8f7-4d4d-97dd-cd65f336e638"],
Cell[133773, 3060, 1913, 39, 71, "Output",ExpressionUUID->"95234e29-2654-4b29-a471-7dd323e76a93"],
Cell[135689, 3101, 1537, 24, 65, "Output",ExpressionUUID->"deeb14f0-97c6-4fc3-a44f-e8957077bd18"],
Cell[137229, 3127, 1500, 23, 62, "Output",ExpressionUUID->"c41b60d5-526a-4b6c-83f9-dbf714663410"],
Cell[138732, 3152, 1500, 21, 32, "Output",ExpressionUUID->"29cbf56a-ac91-48a1-bf59-55f24d5c7c5b"],
Cell[140235, 3175, 1537, 24, 65, "Output",ExpressionUUID->"d560780f-55a3-4fe2-b6c0-87eb7f80936c"],
Cell[141775, 3201, 1502, 23, 62, "Output",ExpressionUUID->"c4d361cb-d617-4b35-9e9d-c09fa37a25c0"],
Cell[143280, 3226, 2027, 42, 71, "Output",ExpressionUUID->"1f4a6b3a-86d1-4622-a657-19955351c2ab"],
Cell[145310, 3270, 2011, 42, 84, "Output",ExpressionUUID->"edca7a63-542b-4ef9-adc0-8fca03f56d0b"],
Cell[147324, 3314, 1940, 40, 84, "Output",ExpressionUUID->"2c449af5-5339-4d6b-bd45-235b75cd7253"],
Cell[149267, 3356, 2071, 44, 101, "Output",ExpressionUUID->"289c6f0d-37c3-43e4-8463-fb52fcc87258"],
Cell[151341, 3402, 2036, 43, 98, "Output",ExpressionUUID->"fd757d17-b1a4-44ff-b918-66ed5c499b4a"],
Cell[153380, 3447, 1491, 21, 32, "Output",ExpressionUUID->"5727d5da-b3a9-4dc3-b0f9-7b5c0a2bf395"],
Cell[154874, 3470, 1578, 26, 65, "Output",ExpressionUUID->"574af02a-5678-42f9-a293-747fcbc650a6"],
Cell[156455, 3498, 1543, 25, 62, "Output",ExpressionUUID->"27592fac-4ae1-4a42-ac63-77f7195fe42b"],
Cell[158001, 3525, 2110, 45, 76, "Output",ExpressionUUID->"cfeeead8-6395-4db0-b80d-9383135044d3"],
Cell[160114, 3572, 1485, 22, 37, "Output",ExpressionUUID->"98893cad-ade4-45c0-ae1f-9864277b75b3"],
Cell[161602, 3596, 1537, 22, 32, "Output",ExpressionUUID->"f9a33df0-fe17-466c-ab3f-afa10e7bff7a"],
Cell[163142, 3620, 1662, 27, 32, "Output",ExpressionUUID->"e7873b26-63bb-439b-b130-48a28db95862"],
Cell[164807, 3649, 1660, 27, 32, "Output",ExpressionUUID->"63ebcd32-6a04-4969-87da-71deba9ee842"],
Cell[166470, 3678, 1512, 21, 32, "Output",ExpressionUUID->"934d9256-ec0c-46fb-b462-1c1b1b8e6f0a"],
Cell[167985, 3701, 2226, 44, 96, "Output",ExpressionUUID->"6cd4f37a-0c03-4d0b-8cc3-cdaddc774c59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170248, 3750, 22622, 653, 851, "Input",ExpressionUUID->"b83016c3-f0ae-4f4c-ae8a-bf8f4e20c1ae"],
Cell[192873, 4405, 612, 8, 32, "Output",ExpressionUUID->"788593e5-c251-44d4-9076-c085fd2521bf"],
Cell[193488, 4415, 611, 8, 32, "Output",ExpressionUUID->"60a73f94-9583-4fb2-a4e0-805c1da1af71"],
Cell[194102, 4425, 1435, 35, 130, "Output",ExpressionUUID->"f15444fa-71ea-4e70-8b09-7d6250003da8"],
Cell[195540, 4462, 616, 8, 32, "Output",ExpressionUUID->"8733887f-c842-443c-b48a-e53ae3ab86e6"],
Cell[196159, 4472, 1744, 48, 90, "Output",ExpressionUUID->"ab0cafd4-52f6-4e77-92b7-d4b056866ebf"],
Cell[197906, 4522, 635, 8, 32, "Output",ExpressionUUID->"84242ea6-aa2c-403b-af19-11055bd8185d"],
Cell[198544, 4532, 1452, 37, 90, "Output",ExpressionUUID->"5e2121c3-d2b4-4fcf-9c89-ddd7fc843a3c"],
Cell[199999, 4571, 629, 8, 32, "Output",ExpressionUUID->"7f26518c-32b0-4daa-9e17-19e9ab45b885"],
Cell[200631, 4581, 5207, 172, 380, "Output",ExpressionUUID->"9bd2652d-71d5-41c3-b022-7f7e8205cb64"],
Cell[205841, 4755, 664, 9, 32, "Output",ExpressionUUID->"ae01d1dc-0524-4303-8327-7f44e3b99b75"],
Cell[206508, 4766, 1472, 34, 130, "Output",ExpressionUUID->"3ae488ef-3987-4c93-bb1c-dd78680a59fb"],
Cell[207983, 4802, 677, 10, 32, "Output",ExpressionUUID->"be002970-02dc-4adf-adc3-b68007b86af3"],
Cell[208663, 4814, 1426, 31, 130, "Output",ExpressionUUID->"cacd7a10-2278-4e3e-9611-1499c5ba7b08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210126, 4850, 22288, 654, 1131, "Input",ExpressionUUID->"97d972f3-02d1-4eab-94b7-14ed63715c10"],
Cell[232417, 5506, 851, 13, 32, "Output",ExpressionUUID->"4a2d0e0a-2bb2-4d8a-82c7-afc85304d5e5"],
Cell[233271, 5521, 839, 13, 32, "Output",ExpressionUUID->"794a5ad0-aee4-4df6-beda-7255963d4bc9"],
Cell[234113, 5536, 1876, 47, 196, "Output",ExpressionUUID->"9ee8c1f8-20a9-4ddf-82ae-0925a13deaad"],
Cell[235992, 5585, 846, 13, 32, "Output",ExpressionUUID->"85958892-b6a7-4ee7-9a2a-241dd0bc915c"],
Cell[236841, 5600, 937, 18, 53, "Output",ExpressionUUID->"7e0b938a-cb9d-4434-879a-84c75c88ca2b"],
Cell[237781, 5620, 906, 14, 32, "Output",ExpressionUUID->"0165bb4f-b048-4a71-b860-5591baf4e4e9"],
Cell[238690, 5636, 1946, 49, 196, "Output",ExpressionUUID->"7f13bc0d-d1ce-42ad-b976-f9380718fa6c"],
Cell[240639, 5687, 881, 14, 32, "Output",ExpressionUUID->"7bbb2003-bb76-4d56-bb5b-c3433ce0089d"],
Cell[241523, 5703, 2638, 69, 90, "Output",ExpressionUUID->"1f9330e2-d7ef-4e21-ac62-79530d48efe3"],
Cell[244164, 5774, 864, 13, 32, "Output",ExpressionUUID->"0f21eb36-fe60-47b3-88f1-49ee08641ee9"],
Cell[245031, 5789, 1057, 21, 36, "Output",ExpressionUUID->"e05852fe-305e-44cd-91e3-cb8d9c29bf0a"],
Cell[246091, 5812, 884, 14, 32, "Output",ExpressionUUID->"75347752-b2a4-44f1-8d4d-563d2e58382e"],
Cell[246978, 5828, 4800, 153, 300, "Output",ExpressionUUID->"e71c58ba-32b6-4252-85b8-88e856605b48"],
Cell[251781, 5983, 852, 13, 32, "Output",ExpressionUUID->"3814ab03-b49b-40b6-bc16-77177c262cec"],
Cell[252636, 5998, 1642, 38, 130, "Output",ExpressionUUID->"6b21d308-a8a1-4ebb-9112-766de4297c6e"],
Cell[254281, 6038, 865, 13, 32, "Output",ExpressionUUID->"7c534cda-110d-4fd5-9c81-c45ebf4dd189"],
Cell[255149, 6053, 3388, 89, 228, "Output",ExpressionUUID->"439c20d9-91d5-4500-a5c9-c62477bfbf6a"],
Cell[258540, 6144, 901, 14, 32, "Output",ExpressionUUID->"54165512-2fce-4fba-aa67-428ee9a7a988"],
Cell[259444, 6160, 2344, 71, 248, "Output",ExpressionUUID->"7afc15a5-5803-43f8-87b7-66268ba0e4d9"],
Cell[261791, 6233, 852, 13, 32, "Output",ExpressionUUID->"565dcee7-2727-4025-a6ec-b9fec733c4f8"],
Cell[262646, 6248, 1642, 38, 130, "Output",ExpressionUUID->"f4970d5d-6974-46fa-9986-78a061ce87c9"],
Cell[264291, 6288, 871, 14, 32, "Output",ExpressionUUID->"a60f6eab-f2c7-4512-bb06-5cbf8dfd710e"],
Cell[265165, 6304, 1728, 41, 174, "Output",ExpressionUUID->"fd2d7c39-93f8-47a8-8985-26e0cd6d72e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266930, 6350, 5590, 139, 542, "Input",ExpressionUUID->"41799b29-e124-4aba-8bbf-6dc55633e0c8"],
Cell[272523, 6491, 541, 8, 32, "Output",ExpressionUUID->"ba1cc904-2fb2-47b9-8feb-38be3aad8237"],
Cell[273067, 6501, 547, 10, 32, "Output",ExpressionUUID->"3b20be40-6269-409d-be00-07f410f5f6be"],
Cell[273617, 6513, 547, 10, 32, "Output",ExpressionUUID->"aa585af8-ac76-4b83-9232-14c7d2dc2517"],
Cell[274167, 6525, 583, 9, 32, "Output",ExpressionUUID->"14539c95-541f-493b-be40-5cf0dd3b43d6"],
Cell[274753, 6536, 13756, 261, 71, "Output",ExpressionUUID->"c575703d-4dbd-43e3-8f3f-eaacda6b1592"],
Cell[288512, 6799, 585, 9, 32, "Output",ExpressionUUID->"7d151882-cca1-4bc6-b3b2-60585f96a975"],
Cell[289100, 6810, 13745, 261, 71, "Output",ExpressionUUID->"8511a4aa-27a3-46d0-97bc-20f64735d6fb"],
Cell[302848, 7073, 529, 8, 32, "Output",ExpressionUUID->"f70391f0-6dda-431e-a39f-e12e280eed8a"],
Cell[303380, 7083, 496, 8, 32, "Output",ExpressionUUID->"c1aff182-ed08-462d-bcb6-c5bfb0c43a4b"],
Cell[303879, 7093, 543, 8, 32, "Output",ExpressionUUID->"0d23bdf4-6be4-4cb2-9630-35888455aba6"],
Cell[304425, 7103, 496, 8, 32, "Output",ExpressionUUID->"70174d7d-1cd8-40da-a394-c636daba83d8"],
Cell[304924, 7113, 543, 8, 32, "Output",ExpressionUUID->"4e9c8bd5-3608-402c-8746-cd200c2d70c8"],
Cell[305470, 7123, 494, 8, 32, "Output",ExpressionUUID->"74676b47-0c7c-433f-9c6f-55af928acc46"],
Cell[305967, 7133, 570, 9, 32, "Output",ExpressionUUID->"98088130-a842-4c53-a9e0-8b35edf11b49"],
Cell[306540, 7144, 548, 10, 32, "Output",ExpressionUUID->"80f64ec7-1224-4c05-bd19-2d1359d516af"],
Cell[307091, 7156, 550, 10, 65, "Output",ExpressionUUID->"19d1ca70-5291-4897-99db-1543f3a3b8af"]
}, Open  ]]
}
]
*)

